{"ast":null,"code":"function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n/*!\n    *\n    * Wijmo Library 5.20213.824\n    * http://wijmo.com/\n    *\n    * Copyright(c) GrapeCity, Inc.  All rights reserved.\n    *\n    * Licensed under the GrapeCity Commercial License.\n    * sales@wijmo.com\n    * wijmo.com/products/wijmo-5/license/\n    *\n    */\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(e, t) {\n    return (_extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (e, t) {\n      e.__proto__ = t;\n    } || function (e, t) {\n      for (var o in t) {\n        t.hasOwnProperty(o) && (e[o] = t[o]);\n      }\n    })(e, t);\n  };\n\n  return function (e, t) {\n    _extendStatics(e, t);\n\n    function __() {\n      this.constructor = e;\n    }\n\n    e.prototype = null === t ? Object.create(t) : (__.prototype = t.prototype, new __());\n  };\n}();\n\nimport { culture, isDate, isNumber, isInt, isFunction, isString, asEnum, assert, saveFile, Color, isNullOrWhiteSpace, isObject, isBoolean, isIE, _registerModule } from \"@grapecity/wijmo\";\nimport * as selfModule from \"@grapecity/wijmo.xlsx\";\nimport JSZipRef from \"jszip\";\n\nvar Workbook = function () {\n  function Workbook() {\n    this._externalCancellation = null;\n  }\n\n  Object.defineProperty(Workbook.prototype, \"sheets\", {\n    get: function get() {\n      null == this._sheets && (this._sheets = []);\n      return this._sheets;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Workbook.prototype, \"styles\", {\n    get: function get() {\n      null == this._styles && (this._styles = []);\n      return this._styles;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Workbook.prototype, \"definedNames\", {\n    get: function get() {\n      null == this._definedNames && (this._definedNames = []);\n      return this._definedNames;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Workbook.prototype, \"colorThemes\", {\n    get: function get() {\n      null == this._colorThemes && (this._colorThemes = []);\n      return this._colorThemes;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Workbook.prototype, \"reservedContent\", {\n    get: function get() {\n      null == this._reservedContent && (this._reservedContent = {});\n      return this._reservedContent;\n    },\n    set: function set(e) {\n      this._reservedContent = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n\n  Workbook.prototype.save = function (e) {\n    var t = _xlsx.save(this),\n        o = !(!this._reservedContent || !this._reservedContent.macros);\n\n    e && Workbook._saveToFile(t.base64, e, o);\n    return t.base64;\n  };\n\n  Workbook.prototype.saveAsync = function (e, t, o, r) {\n    var l = this;\n    this.cancelAsync(function () {\n      l._cs = isFunction(l._externalCancellation) ? l._externalCancellation() : new _SyncPromise();\n\n      _xlsx.saveAsync(l, l._cs, o, r).then(function (o) {\n        if (e) {\n          var i = !(!l._reservedContent || !l._reservedContent.macros);\n\n          Workbook._saveToFile(o, e, i);\n        }\n\n        l._cs = null;\n        isFunction(r) && r(100);\n        t && t(o);\n      }, function () {\n        return l._cs = null;\n      });\n    });\n  };\n\n  Workbook.prototype.cancelAsync = function (e) {\n    var t = this;\n\n    if (this._cs) {\n      this._cs.cancel();\n\n      setTimeout(function () {\n        t._cs = null;\n        isFunction(e) && e();\n      }, 100);\n    } else isFunction(e) && e();\n  };\n\n  Workbook.prototype.load = function (e) {\n    isString(e) && (e = this._getBase64String(e));\n\n    var t = _xlsx.load(e);\n\n    this._deserialize(t);\n\n    e = null;\n    t = null;\n  };\n\n  Workbook.prototype.loadAsync = function (e, t, o) {\n    var r = this;\n    isString(e) && (e = this._getBase64String(e));\n\n    _xlsx.loadAsync(e).then(function (o) {\n      r._deserialize(o);\n\n      e = null;\n      o = null;\n      t(r);\n    }).catch(o);\n  };\n\n  Workbook.prototype._serialize = function () {\n    var e = {\n      sheets: []\n    };\n    e.sheets = this._serializeWorkSheets();\n    this._styles && this._styles.length > 0 && (e.styles = this._serializeWorkbookStyles());\n    this._reservedContent && (e.reservedContent = this._reservedContent);\n    null != this.activeWorksheet && !isNaN(this.activeWorksheet) && this.activeWorksheet >= 0 && (e.activeWorksheet = this.activeWorksheet);\n    this.application && (e.application = this.application);\n    this.company && (e.company = this.company);\n    null != this.created && (e.created = this.created);\n    this.creator && (e.creator = this.creator);\n    this.lastModifiedBy && (e.lastModifiedBy = this.lastModifiedBy);\n    null != this.modified && (e.modified = this.modified);\n    this._definedNames && this._definedNames.length > 0 && (e.definedNames = this._serializeDefinedNames());\n    this._colorThemes && this._colorThemes.length > 0 && (e.colorThemes = this._colorThemes.slice());\n    return e;\n  };\n\n  Workbook.prototype._deserialize = function (e) {\n    this._deserializeWorkSheets(e.sheets);\n\n    e.styles && e.styles.length > 0 && this._deserializeWorkbookStyles(e.styles);\n    this.activeWorksheet = e.activeWorksheet;\n    this.application = e.application;\n    this.company = e.company;\n    this.created = e.created;\n    this.creator = e.creator;\n    this.lastModifiedBy = e.lastModifiedBy;\n    this.modified = e.modified;\n    this.reservedContent = e.reservedContent;\n    e.definedNames && e.definedNames.length > 0 && this._deserializeDefinedNames(e.definedNames);\n    e.colorThemes && e.colorThemes.length > 0 && (this._colorThemes = e.colorThemes.slice());\n  };\n\n  Workbook.prototype._addWorkSheet = function (e, t) {\n    null == this._sheets && (this._sheets = []);\n    null == t || isNaN(t) ? this._sheets.push(e) : this._sheets[t] = e;\n  };\n\n  Workbook._saveToFile = function (e, t, o) {\n    var r,\n        l,\n        i = o ? \"xlsm\" : \"xlsx\",\n        s = \"xlsm\" === i ? \"application/vnd.ms-excel.sheet.macroEnabled.12\" : \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\";\n    if ((l = t.lastIndexOf(\".\")) < 0) t += \".\" + i;else {\n      if (0 === l) throw \"Invalid file name.\";\n      \"\" === (r = t.substring(l + 1)) ? t += \".\" + i : r !== i && (t += \".\" + i);\n    }\n    saveFile(new Blob([_Base64.toArray(e)], {\n      type: s\n    }), t);\n  };\n\n  Workbook.prototype._getBase64String = function (e) {\n    if (null == e || 0 === e.length) throw \"Invalid xlsx file content.\";\n    var t = e.search(/base64,/i);\n    return -1 !== t ? e.substring(t + 7) : e;\n  };\n\n  Workbook.toXlsxDateFormat = function (e) {\n    var t;\n    if (1 === e.length) switch (e) {\n      case \"r\":\n      case \"R\":\n        return \"ddd, dd MMM yyyy HH:mm:ss &quot;GMT&quot;\";\n\n      case \"u\":\n        return \"yyyy-MM-dd&quot;T&quot;HH:mm:ss&quot;Z&quot;\";\n\n      case \"o\":\n      case \"O\":\n        t = (t = culture.Globalize.calendar.patterns[e]).replace(/f+k/gi, \"000\");\n        break;\n\n      default:\n        t = culture.Globalize.calendar.patterns[e];\n    }\n    t || (t = e);\n    t = t.replace(/\"/g, \"\").replace(/tt/, \"AM/PM\").replace(/t/, \"A/P\").replace(/M+/gi, function (e) {\n      return e.toLowerCase();\n    }).replace(/g+y+/gi, function (e) {\n      return e.substring(0, e.indexOf(\"y\")) + \"e\";\n    });\n    return /FY|Q/i.test(t) ? \"General\" : t;\n  };\n\n  Workbook.toXlsxNumberFormat = function (e) {\n    var t,\n        o,\n        r,\n        l = e ? e.toLowerCase() : \"\";\n\n    if (/^[ncpfdg]\\d*.*,*$/.test(l)) {\n      t = l[0];\n      o = this._formatMap[t];\n    }\n\n    if (o) {\n      var i = l.split(\",\");\n\n      if (\"c\" === t) {\n        var s = culture.Globalize.numberFormat.currency,\n            n = e ? e.match(/([a-z])(\\d*)(,*)(.*)/i) : null,\n            a = n && n[4] ? n[4] : s.symbol;\n        \"​\" === a && (a = \"\");\n        var h = this._formatMap.n,\n            f = s.pattern,\n            u = f[0].replace(\"n\", h).replace(\"$\", \"{1}\"),\n            c = f[1].replace(\"n\", h).replace(\"$\", \"{1}\");\n        \")\" === u[u.length - 1] && (c += \"_)\");\n        o = (o = c + \";\" + u).replace(/\\{1\\}/g, a);\n      }\n\n      var d = -1;\n      l.length > 1 ? d = parseInt(i[0].substr(1)) : \"d\" !== t && (d = 2);\n      var m = \"\";\n      if (!isNaN(d)) for (var p = 0; p < d; p++) {\n        m += \"0\";\n      }\n\n      for (p = 0; p < i.length - 1; p++) {\n        m += \",\";\n      }\n\n      r = m.length > 0 ? \"d\" === t ? o.replace(/\\{0\\}/g, m) : o.replace(/\\{0\\}/g, (!isNaN(d) && d > 0 ? \".\" : \"\") + m) : \"d\" === t ? o.replace(/\\{0\\}/g, \"0\") : o.replace(/\\{0\\}/g, \"\");\n    } else r = l;\n\n    return r;\n  };\n\n  Workbook.fromXlsxFormat = function (e) {\n    var t,\n        o,\n        r,\n        l,\n        i,\n        s,\n        n,\n        a,\n        h,\n        f = [],\n        u = culture.Globalize.numberFormat.currency.symbol;\n    if (!e || \"General\" === e) return [\"\"];\n    o = (e = e.replace(/;@/g, \"\").replace(/&quot;?/g, \"\")).split(\";\");\n\n    for (l = 0; l < o.length; l++) {\n      r = o[l];\n      if (/[hsmy\\:]/i.test(r)) t = this._fromXlsxDateFormat(r);else {\n        s = r.lastIndexOf(\".\");\n        n = r.lastIndexOf(\"0\");\n        a = r.lastIndexOf(\",\");\n        t = r.search(/\\[\\$([^\\-\\]]+)[^\\]]*\\]/) > -1 || r.indexOf(u) > -1 && -1 === r.search(/\\[\\$([\\-\\]]+)[^\\]]*\\]/) ? \"c\" : \"%\" === r[e.length - 1] ? \"p\" : \"n\";\n        t += s > -1 && s < n ? r.substring(s, n).length : \"0\";\n        /^0+,*$/.test(r) && (t = \"d\" + ((n = r.lastIndexOf(\"0\")) + 1));\n\n        if (a > -1 && n > -1 && n < a) {\n          h = r.substring(n + 1, a + 1).split(\"\");\n\n          for (i = 0; i < h.length; i++) {\n            t += \",\";\n          }\n        }\n      }\n      f.push(t);\n    }\n\n    return f;\n  };\n\n  Workbook._fromXlsxDateFormat = function (e) {\n    return e.replace(/\\[\\$\\-.+\\]/g, \"\").replace(/(\\\\)(.)/g, \"$2\").replace(/H+/g, function (e) {\n      return e.toLowerCase();\n    }).replace(/m+/g, function (e) {\n      return e.toUpperCase();\n    }).replace(/S+/g, function (e) {\n      return e.toLowerCase();\n    }).replace(/AM\\/PM/gi, \"tt\").replace(/A\\/P/gi, \"t\").replace(/\\.000/g, \".fff\").replace(/\\.00/g, \".ff\").replace(/\\.0/g, \".f\").replace(/\\\\[\\-\\s,]/g, function (e) {\n      return e.substring(1);\n    }).replace(/Y+/g, function (e) {\n      return e.toLowerCase();\n    }).replace(/D+/g, function (e) {\n      return e.toLowerCase();\n    }).replace(/M+:?|:?M+/gi, function (e) {\n      return e.indexOf(\":\") > -1 ? e.toLowerCase() : e;\n    }).replace(/g+e/gi, function (e) {\n      return e.substring(0, e.length - 1) + \"yy\";\n    });\n  };\n\n  Workbook._parseCellFormat = function (e, t) {\n    return t ? this.toXlsxDateFormat(e) : this.toXlsxNumberFormat(e);\n  };\n\n  Workbook._parseExcelFormat = function (e) {\n    if (null != e) {\n      var t = e && e.style && e.style.format;\n\n      if ((null != e.value || t) && !isNaN(e.value)) {\n        var o = isNumber(e.value);\n        return !o || t && \"General\" !== t ? e.isDate || isDate(e.value) || o || \"\" === e.value || e.isNumber ? this.fromXlsxFormat(t)[0] : t : isInt(e.value) ? \"d\" : \"f2\";\n      }\n    }\n  };\n\n  Workbook.xlsxAddress = function (e, t, o, r, l) {\n    var i = o ? \"$\" : \"\",\n        s = null == r ? i : r ? \"$\" : \"\";\n    return !0 === l ? \"\" : (isNaN(t) ? \"\" : s + this._numAlpha(t)) + (!1 === l ? \"\" : isNaN(e) ? \"\" : i + (e + 1).toString());\n  };\n\n  Workbook.tableAddress = function (e) {\n    var t = e && /^((\\$?)([A-Za-z]+))?((\\$?)(\\d+))?$/.exec(e),\n        o = {};\n    if (!t) return null;\n\n    if (t[3]) {\n      o.col = this._alphaNum(t[3]);\n      o.absCol = !!t[2];\n    }\n\n    if (t[6]) {\n      o.row = +t[6] - 1;\n      o.absRow = !!t[5];\n    }\n\n    return o;\n  };\n\n  Workbook._parseHAlignToString = function (e) {\n    switch (e) {\n      case HAlign.Left:\n        return \"left\";\n\n      case HAlign.Center:\n        return \"center\";\n\n      case HAlign.Right:\n        return \"right\";\n\n      case HAlign.Justify:\n        return \"justify\";\n\n      default:\n        return \"general\";\n    }\n  };\n\n  Workbook._parseStringToHAlign = function (e) {\n    var t = e ? e.toLowerCase() : \"\";\n    return \"left\" === t ? HAlign.Left : \"center\" === t ? HAlign.Center : \"right\" === t ? HAlign.Right : \"justify\" === t ? HAlign.Justify : HAlign.General;\n  };\n\n  Workbook._parseVAlignToString = function (e) {\n    switch (e) {\n      case VAlign.Bottom:\n        return \"bottom\";\n\n      case VAlign.Center:\n        return \"center\";\n\n      case VAlign.Top:\n        return \"top\";\n\n      default:\n        return null;\n    }\n  };\n\n  Workbook._parseStringToVAlign = function (e) {\n    var t = e ? e.toLowerCase() : \"\";\n    return \"top\" === t ? VAlign.Top : \"center\" === t ? VAlign.Center : \"bottom\" === t ? VAlign.Bottom : null;\n  };\n\n  Workbook._parseBorderTypeToString = function (e) {\n    switch (e) {\n      case BorderStyle.Dashed:\n        return \"dashed\";\n\n      case BorderStyle.Dotted:\n        return \"dotted\";\n\n      case BorderStyle.Double:\n        return \"double\";\n\n      case BorderStyle.Hair:\n        return \"hair\";\n\n      case BorderStyle.Medium:\n        return \"medium\";\n\n      case BorderStyle.MediumDashDotDotted:\n        return \"mediumDashDotDot\";\n\n      case BorderStyle.MediumDashDotted:\n        return \"mediumDashDot\";\n\n      case BorderStyle.MediumDashed:\n        return \"mediumDashed\";\n\n      case BorderStyle.SlantedMediumDashDotted:\n        return \"slantDashDot\";\n\n      case BorderStyle.Thick:\n        return \"thick\";\n\n      case BorderStyle.Thin:\n        return \"thin\";\n\n      case BorderStyle.ThinDashDotDotted:\n        return \"dashDotDot\";\n\n      case BorderStyle.ThinDashDotted:\n        return \"dashDot\";\n\n      case BorderStyle.None:\n      default:\n        return \"none\";\n    }\n  };\n\n  Workbook._parseStringToBorderType = function (e) {\n    return \"dashed\" === e ? BorderStyle.Dashed : \"dotted\" === e ? BorderStyle.Dotted : \"double\" === e ? BorderStyle.Double : \"hair\" === e ? BorderStyle.Hair : \"medium\" === e ? BorderStyle.Medium : \"mediumDashDotDot\" === e ? BorderStyle.MediumDashDotDotted : \"mediumDashDot\" === e ? BorderStyle.MediumDashDotted : \"mediumDashed\" === e ? BorderStyle.MediumDashed : \"slantDashDot\" === e ? BorderStyle.SlantedMediumDashDotted : \"thick\" === e ? BorderStyle.Thick : \"thin\" === e ? BorderStyle.Thin : \"dashDotDot\" === e ? BorderStyle.ThinDashDotDotted : \"dashDot\" === e ? BorderStyle.ThinDashDotted : null;\n  };\n\n  Workbook._escapeXML = function (e) {\n    return \"string\" == typeof e ? e.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/\"/g, \"&quot;\") : \"\";\n  };\n\n  Workbook._unescapeXML = function (e) {\n    return \"string\" == typeof e ? e.indexOf(\"&\") >= 0 ? e.replace(/&lt;/g, \"<\").replace(/&gt;/g, \">\").replace(/&quot;/g, '\"').replace(/&#x27;/g, \"'\").replace(/&#x2F;/g, \"/\").replace(/&amp;/g, \"&\") : e : \"\";\n  };\n\n  Workbook._numAlpha = function (e) {\n    var t = Math.floor(e / 26) - 1;\n    return (t > -1 ? this._numAlpha(t) : \"\") + this._alphabet.charAt(e % 26);\n  };\n\n  Workbook._alphaNum = function (e) {\n    var t = 0;\n    e && (e = e.toUpperCase());\n    2 === e.length && (t = this._alphaNum(e.charAt(0)) + 1);\n    return 26 * t + this._alphabet.indexOf(e.substr(-1));\n  };\n\n  Workbook.prototype._serializeWorkSheets = function () {\n    var e,\n        t,\n        o = [];\n\n    for (t = 0; t < this._sheets.length; t++) {\n      (e = this._sheets[t]) && (o[t] = e._serialize());\n    }\n\n    return o;\n  };\n\n  Workbook.prototype._serializeWorkbookStyles = function () {\n    var e,\n        t,\n        o = [];\n\n    for (t = 0; t < this._styles.length; t++) {\n      (e = this._styles[t]) && (o[t] = e._serialize());\n    }\n\n    return o;\n  };\n\n  Workbook.prototype._serializeDefinedNames = function () {\n    var e,\n        t,\n        o = [];\n\n    for (t = 0; t < this._definedNames.length; t++) {\n      (e = this._definedNames[t]) && (o[t] = e._serialize());\n    }\n\n    return o;\n  };\n\n  Workbook.prototype._serializeTableStyles = function () {\n    var e,\n        t,\n        o = [];\n\n    for (t = 0; t < this._tableStyles.length; t++) {\n      (e = this._tableStyles[t]) && (o[t] = e._serialize());\n    }\n\n    return o;\n  };\n\n  Workbook.prototype._deserializeWorkSheets = function (e) {\n    var t, o, r;\n    this._sheets = [];\n    assert(null != e, \"workSheets should not be null.\");\n\n    for (r = 0; r < e.length; r++) {\n      if (o = e[r]) {\n        (t = new WorkSheet())._deserialize(o);\n\n        this._sheets[r] = t;\n      }\n    }\n  };\n\n  Workbook.prototype._deserializeWorkbookStyles = function (e) {\n    var t, o, r;\n    this._styles = [];\n\n    for (r = 0; r < e.length; r++) {\n      if (o = e[r]) {\n        (t = new WorkbookStyle())._deserialize(o);\n\n        this._styles[r] = t;\n      }\n    }\n  };\n\n  Workbook.prototype._deserializeDefinedNames = function (e) {\n    var t, o, r;\n    this._definedNames = [];\n\n    for (r = 0; r < e.length; r++) {\n      if (o = e[r]) {\n        (t = new DefinedName())._deserialize(o);\n\n        this._definedNames[r] = t;\n      }\n    }\n  };\n\n  Workbook.prototype._deserializeTableStyles = function (e) {\n    var t, o, r;\n    this._tableStyles = [];\n\n    for (r = 0; r < e.length; r++) {\n      if (o = e[r]) {\n        (t = new WorkbookTableStyle())._deserialize(o);\n\n        this._tableStyles[r] = t;\n      }\n    }\n  };\n\n  Workbook._alphabet = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n  Workbook._formatMap = {\n    n: \"#,##0{0}\",\n    c: \"{1}#,##0{0}_);({1}#,##0{0})\",\n    p: \"#,##0{0}%\",\n    f: \"0{0}\",\n    d: \"{0}\",\n    g: \"0{0}\"\n  };\n  return Workbook;\n}();\n\nexport { Workbook };\n\nvar WorkSheet = function () {\n  function WorkSheet() {}\n\n  Object.defineProperty(WorkSheet.prototype, \"columns\", {\n    get: function get() {\n      null == this._columns && (this._columns = []);\n      return this._columns;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(WorkSheet.prototype, \"rows\", {\n    get: function get() {\n      null == this._rows && (this._rows = []);\n      return this._rows;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(WorkSheet.prototype, \"tables\", {\n    get: function get() {\n      null == this._tables && (this._tables = []);\n      return this._tables;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n\n  WorkSheet.prototype._serialize = function () {\n    var e;\n    if (this._checkEmptyWorkSheet()) return null;\n    e = {};\n    this.style && (e.style = this.style._serialize());\n    this._columns && this._columns.length > 0 && (e.columns = this._serializeWorkbookColumns());\n    this._rows && this._rows.length > 0 && (e.rows = this._serializeWorkbookRows());\n    this.frozenPane && (e.frozenPane = this.frozenPane._serialize());\n    this.name && (e.name = this.name);\n    null != this.summaryBelow && (e.summaryBelow = this.summaryBelow);\n    null != this.visible && (e.visible = this.visible);\n    this._tables && this._tables.length > 0 && (e.tables = this._serializeTables());\n    this._extraColumn && (e._extraColumn = this._extraColumn._serialize());\n    return e;\n  };\n\n  WorkSheet.prototype._deserialize = function (e) {\n    var t, o;\n\n    if (e.style) {\n      (o = new WorkbookStyle())._deserialize(e.style);\n\n      this.style = o;\n    }\n\n    e.columns && e.columns.length > 0 && this._deserializeWorkbookColumns(e.columns);\n    e.rows && e.rows.length > 0 && this._deserializeWorkbookRows(e.rows);\n\n    if (e.frozenPane) {\n      (t = new WorkbookFrozenPane())._deserialize(e.frozenPane);\n\n      this.frozenPane = t;\n    }\n\n    this.name = e.name;\n    this.summaryBelow = e.summaryBelow;\n    this.visible = e.visible;\n    e.tables && e.tables.length > 0 && this._deserializeTables(e.tables);\n\n    if (e._extraColumn) {\n      this._extraColumn = new _WorkbookExtraColumn();\n\n      this._extraColumn._deserialize(e._extraColumn);\n    }\n  };\n\n  WorkSheet.prototype._addWorkbookColumn = function (e, t) {\n    null == this._columns && (this._columns = []);\n    null == t || isNaN(t) ? this._columns.push(e) : this._columns[t] = e;\n  };\n\n  WorkSheet.prototype._addWorkbookRow = function (e, t) {\n    null == this._rows && (this._rows = []);\n    null == t || isNaN(t) ? this._rows.push(e) : this._rows[t] = e;\n  };\n\n  WorkSheet.prototype._serializeWorkbookColumns = function () {\n    var e,\n        t,\n        o = [];\n\n    for (t = 0; t < this._columns.length; t++) {\n      (e = this._columns[t]) && (o[t] = e._serialize());\n    }\n\n    return o;\n  };\n\n  WorkSheet.prototype._serializeWorkbookRows = function () {\n    var e,\n        t,\n        o = [];\n\n    for (t = 0; t < this._rows.length; t++) {\n      (e = this._rows[t]) && (o[t] = e._serialize());\n    }\n\n    return o;\n  };\n\n  WorkSheet.prototype._serializeTables = function () {\n    var e,\n        t,\n        o = [];\n\n    for (t = 0; t < this._tables.length; t++) {\n      (e = this._tables[t]) && (o[t] = e._serialize());\n    }\n\n    return o;\n  };\n\n  WorkSheet.prototype._deserializeWorkbookColumns = function (e) {\n    var t, o, r;\n    this._columns = [];\n\n    for (r = 0; r < e.length; r++) {\n      if (t = e[r]) {\n        (o = new WorkbookColumn())._deserialize(t);\n\n        this._columns[r] = o;\n      }\n    }\n  };\n\n  WorkSheet.prototype._deserializeWorkbookRows = function (e) {\n    var t, o, r;\n    this._rows = [];\n\n    for (r = 0; r < e.length; r++) {\n      if (t = e[r]) {\n        (o = new WorkbookRow())._deserialize(t);\n\n        this._rows[r] = o;\n      }\n    }\n  };\n\n  WorkSheet.prototype._deserializeTables = function (e) {\n    var t, o, r;\n    this._tables = [];\n\n    for (r = 0; r < e.length; r++) {\n      if (o = e[r]) {\n        (t = new WorkbookTable())._deserialize(o);\n\n        this._tables[r] = t;\n      }\n    }\n  };\n\n  WorkSheet.prototype._checkEmptyWorkSheet = function () {\n    return !(null != this._rows || null != this._columns || null != this.visible || null != this.summaryBelow || null != this.frozenPane || null != this.style || null != this.name && \"\" !== this.name || null != this._tables && 0 != this._tables.length);\n  };\n\n  return WorkSheet;\n}();\n\nexport { WorkSheet };\n\nvar WorkbookColumn = function () {\n  function WorkbookColumn() {}\n\n  WorkbookColumn.prototype._serialize = function () {\n    var e;\n    if (this._checkEmptyWorkbookColumn()) return null;\n    e = {};\n    this.style && (e.style = this.style._serialize());\n    null != this.autoWidth && (e.autoWidth = this.autoWidth);\n    null != this.width && (e.width = this.width);\n    null != this.visible && (e.visible = this.visible);\n    return e;\n  };\n\n  WorkbookColumn.prototype._deserialize = function (e) {\n    var t;\n\n    if (e.style) {\n      (t = new WorkbookStyle())._deserialize(e.style);\n\n      this.style = t;\n    }\n\n    this.autoWidth = e.autoWidth;\n    this.visible = e.visible;\n    this.width = e.width;\n  };\n\n  WorkbookColumn.prototype._checkEmptyWorkbookColumn = function () {\n    return null == this.style && null == this.width && null == this.autoWidth && null == this.visible;\n  };\n\n  return WorkbookColumn;\n}();\n\nexport { WorkbookColumn };\n\nvar _WorkbookExtraColumn = function (e) {\n  __extends(_WorkbookExtraColumn, e);\n\n  function _WorkbookExtraColumn() {\n    return e.call(this) || this;\n  }\n\n  _WorkbookExtraColumn.prototype._serialize = function () {\n    var t = e.prototype._serialize.call(this);\n\n    t.min = this.min;\n    t.max = this.max;\n    return t;\n  };\n\n  _WorkbookExtraColumn.prototype._deserialize = function (t) {\n    e.prototype._deserialize.call(this, t);\n\n    this.min = t.min;\n    this.max = t.max;\n  };\n\n  return _WorkbookExtraColumn;\n}(WorkbookColumn);\n\nexport { _WorkbookExtraColumn };\n\nvar WorkbookRow = function () {\n  function WorkbookRow() {}\n\n  Object.defineProperty(WorkbookRow.prototype, \"cells\", {\n    get: function get() {\n      null == this._cells && (this._cells = []);\n      return this._cells;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n\n  WorkbookRow.prototype._serialize = function () {\n    var e;\n    if (this._checkEmptyWorkbookRow()) return null;\n    e = {};\n    this._cells && this._cells.length > 0 && (e.cells = this._serializeWorkbookCells());\n    this.style && (e.style = this.style._serialize());\n    null != this.collapsed && (e.collapsed = this.collapsed);\n    null == this.groupLevel || isNaN(this.groupLevel) || (e.groupLevel = this.groupLevel);\n    null == this.height || isNaN(this.height) || (e.height = this.height);\n    null != this.visible && (e.visible = this.visible);\n    return e;\n  };\n\n  WorkbookRow.prototype._deserialize = function (e) {\n    var t;\n    e.cells && e.cells.length > 0 && this._deserializeWorkbookCells(e.cells);\n\n    if (e.style) {\n      (t = new WorkbookStyle())._deserialize(e.style);\n\n      this.style = t;\n    }\n\n    this.collapsed = e.collapsed;\n    this.groupLevel = e.groupLevel;\n    this.height = e.height;\n    this.visible = e.visible;\n  };\n\n  WorkbookRow.prototype._addWorkbookCell = function (e, t) {\n    null == this._cells && (this._cells = []);\n    null == t || isNaN(t) ? this._cells.push(e) : this._cells[t] = e;\n  };\n\n  WorkbookRow.prototype._serializeWorkbookCells = function () {\n    var e,\n        t,\n        o = [];\n\n    for (t = 0; t < this._cells.length; t++) {\n      (e = this._cells[t]) && (o[t] = e._serialize());\n    }\n\n    return o;\n  };\n\n  WorkbookRow.prototype._deserializeWorkbookCells = function (e) {\n    var t, o, r;\n    this._cells = [];\n\n    for (r = 0; r < e.length; r++) {\n      if (t = e[r]) {\n        (o = new WorkbookCell())._deserialize(t);\n\n        this._cells[r] = o;\n      }\n    }\n  };\n\n  WorkbookRow.prototype._checkEmptyWorkbookRow = function () {\n    return null == this._cells && null == this.style && null == this.collapsed && null == this.visible && (null == this.height || isNaN(this.height)) && (null == this.groupLevel || isNaN(this.groupLevel));\n  };\n\n  return WorkbookRow;\n}();\n\nexport { WorkbookRow };\n\nvar WorkbookCell = function () {\n  function WorkbookCell() {}\n\n  WorkbookCell.prototype._serialize = function () {\n    var e;\n    if (this._checkEmptyWorkbookCell()) return null;\n    e = {};\n    this.style && (e.style = this.style._serialize());\n    null != this.value && (e.value = this.value);\n    this.formula && (e.formula = this.formula);\n    null != this.isDate && (e.isDate = this.isDate);\n    null != this.isNumber && (e.isNumber = this.isNumber);\n    null != this.colSpan && !isNaN(this.colSpan) && this.colSpan > 1 && (e.colSpan = this.colSpan);\n    null != this.rowSpan && !isNaN(this.rowSpan) && this.rowSpan > 1 && (e.rowSpan = this.rowSpan);\n    this.link && (e.link = this.link);\n    e.textRuns = _TextRunsSerializer.serialize(this.textRuns);\n    this.note && (e.note = this.note._serialize());\n    return e;\n  };\n\n  WorkbookCell.prototype._deserialize = function (e) {\n    var t;\n\n    if (e.style) {\n      (t = new WorkbookStyle())._deserialize(e.style);\n\n      this.style = t;\n    }\n\n    this.value = e.value;\n    this.formula = e.formula;\n    this.isDate = e.isDate;\n    this.isNumber = e.isNumber;\n    this.colSpan = e.colSpan;\n    this.rowSpan = e.rowSpan;\n    this.link = e.link;\n    this.textRuns = _TextRunsSerializer.deserialize(e.textRuns);\n\n    if (e.note) {\n      this.note = new WorkbookNote();\n\n      this.note._deserialize(e.note);\n    }\n  };\n\n  WorkbookCell.prototype._checkEmptyWorkbookCell = function () {\n    return null == this.style && null == this.value && null == this.isDate && null == this.isNumber && (null == this.formula || \"\" === this.formula) && (null == this.colSpan || isNaN(this.colSpan) || this.colSpan <= 1) && (null == this.rowSpan || isNaN(this.rowSpan) || this.rowSpan <= 1) && (null == this.link || \"\" === this.link);\n  };\n\n  return WorkbookCell;\n}();\n\nexport { WorkbookCell };\n\nvar WorkbookNote = function () {\n  function WorkbookNote() {}\n\n  WorkbookNote.prototype._serialize = function () {\n    if (!(null != this.text || this.textRuns && this.textRuns.length)) return null;\n    var e = {};\n    null != this.author && (e.author = this.author);\n    null != this.text && (e.text = this.text);\n    e.textRuns = _TextRunsSerializer.serialize(this.textRuns);\n    null != this.visible && (e.visible = this.visible);\n    null != this.offsetX && (e.offsetX = this.offsetX);\n    null != this.offsetY && (e.offsetY = this.offsetY);\n    null != this.width && (e.width = this.width);\n    null != this.height && (e.height = this.height);\n    return e;\n  };\n\n  WorkbookNote.prototype._deserialize = function (e) {\n    this.author = e.author;\n    this.text = e.text;\n    this.textRuns = _TextRunsSerializer.deserialize(e.textRuns);\n    this.visible = e.visible;\n    this.offsetX = e.offsetX;\n    this.offsetY = e.offsetY;\n    this.width = e.width;\n    this.height = e.height;\n  };\n\n  return WorkbookNote;\n}();\n\nexport { WorkbookNote };\n\nvar WorkbookFrozenPane = function () {\n  function WorkbookFrozenPane() {}\n\n  WorkbookFrozenPane.prototype._serialize = function () {\n    return null != this.columns && !isNaN(this.columns) && 0 !== this.columns || null != this.rows && !isNaN(this.rows) && 0 !== this.rows ? {\n      columns: this.columns,\n      rows: this.rows\n    } : null;\n  };\n\n  WorkbookFrozenPane.prototype._deserialize = function (e) {\n    this.columns = e.columns;\n    this.rows = e.rows;\n  };\n\n  return WorkbookFrozenPane;\n}();\n\nexport { WorkbookFrozenPane };\n\nvar WorkbookStyle = function () {\n  function WorkbookStyle() {}\n\n  WorkbookStyle.prototype._serialize = function () {\n    var e;\n    if (this._checkEmptyWorkbookStyle()) return null;\n    e = {};\n    this.basedOn && (e.basedOn = this.basedOn._serialize());\n    this.fill && (e.fill = this.fill._serialize());\n    this.font && (e.font = this.font._serialize());\n    this.borders && (e.borders = this.borders._serialize());\n    this.format && (e.format = this.format);\n    null != this.hAlign && (e.hAlign = asEnum(this.hAlign, HAlign, !1));\n    null != this.vAlign && (e.vAlign = asEnum(this.vAlign, VAlign, !1));\n    null == this.indent || isNaN(this.indent) || (e.indent = this.indent);\n    this.wordWrap && (e.wordWrap = this.wordWrap);\n    return e;\n  };\n\n  WorkbookStyle.prototype._deserialize = function (e) {\n    var t, o, r, l;\n\n    if (e.basedOn) {\n      (t = new WorkbookStyle())._deserialize(e.basedOn);\n\n      this.basedOn = t;\n    }\n\n    if (e.fill) {\n      (o = new WorkbookFill())._deserialize(e.fill);\n\n      this.fill = o;\n    }\n\n    if (e.font) {\n      (r = new WorkbookFont())._deserialize(e.font);\n\n      this.font = r;\n    }\n\n    if (e.borders) {\n      (l = new WorkbookBorder())._deserialize(e.borders);\n\n      this.borders = l;\n    }\n\n    this.format = e.format;\n    null != e.hAlign && (this.hAlign = asEnum(e.hAlign, HAlign, !1));\n    null != e.vAlign && (this.vAlign = asEnum(e.vAlign, VAlign, !1));\n    null == e.indent || isNaN(e.indent) || (this.indent = e.indent);\n    e.wordWrap && (this.wordWrap = e.wordWrap);\n  };\n\n  WorkbookStyle.prototype._checkEmptyWorkbookStyle = function () {\n    return null == this.basedOn && null == this.fill && null == this.font && null == this.borders && (null == this.format || \"\" === this.format) && null == this.hAlign && null == this.vAlign && null == this.wordWrap;\n  };\n\n  return WorkbookStyle;\n}();\n\nexport { WorkbookStyle };\n\nvar WorkbookFont = function () {\n  function WorkbookFont() {}\n\n  WorkbookFont.prototype._serialize = function () {\n    var e;\n    if (this._checkEmptyWorkbookFont()) return null;\n    e = {};\n    null != this.bold && (e.bold = this.bold);\n    null != this.italic && (e.italic = this.italic);\n    null != this.underline && (e.underline = this.underline);\n    this.color && (e.color = this.color);\n    this.family && (e.family = this.family);\n    null == this.size || isNaN(this.size) || (e.size = this.size);\n    return e;\n  };\n\n  WorkbookFont.prototype._deserialize = function (e) {\n    this.bold = e.bold;\n    null != e.color && (this.color = e.color);\n    this.family = e.family;\n    this.italic = e.italic;\n    this.size = e.size;\n    this.underline = e.underline;\n  };\n\n  WorkbookFont.prototype._checkEmptyWorkbookFont = function () {\n    return null == this.bold && null == this.italic && null == this.underline && (null == this.color || \"\" === this.color) && (null == this.family || \"\" === this.family) && (null == this.size || isNaN(this.size));\n  };\n\n  return WorkbookFont;\n}();\n\nexport { WorkbookFont };\n\nvar WorkbookFill = function () {\n  function WorkbookFill() {}\n\n  WorkbookFill.prototype._serialize = function () {\n    return this.color ? {\n      color: this.color\n    } : null;\n  };\n\n  WorkbookFill.prototype._deserialize = function (e) {\n    null != e.color && (this.color = e.color);\n  };\n\n  return WorkbookFill;\n}();\n\nexport { WorkbookFill };\n\nvar WorkbookBorder = function () {\n  function WorkbookBorder() {}\n\n  WorkbookBorder.prototype._serialize = function () {\n    var e;\n    if (this._checkEmptyWorkbookBorder()) return null;\n    e = {};\n    this.top && (e.top = this.top._serialize());\n    this.bottom && (e.bottom = this.bottom._serialize());\n    this.left && (e.left = this.left._serialize());\n    this.right && (e.right = this.right._serialize());\n    this.diagonal && (e.diagonal = this.diagonal._serialize());\n    return e;\n  };\n\n  WorkbookBorder.prototype._deserialize = function (e) {\n    var t, o, r, l, i;\n\n    if (e.top) {\n      (t = new WorkbookBorderSetting())._deserialize(e.top);\n\n      this.top = t;\n    }\n\n    if (e.bottom) {\n      (o = new WorkbookBorderSetting())._deserialize(e.bottom);\n\n      this.bottom = o;\n    }\n\n    if (e.left) {\n      (r = new WorkbookBorderSetting())._deserialize(e.left);\n\n      this.left = r;\n    }\n\n    if (e.right) {\n      (l = new WorkbookBorderSetting())._deserialize(e.right);\n\n      this.right = l;\n    }\n\n    if (e.diagonal) {\n      (i = new WorkbookBorderSetting())._deserialize(e.diagonal);\n\n      this.diagonal = i;\n    }\n  };\n\n  WorkbookBorder.prototype._checkEmptyWorkbookBorder = function () {\n    return null == this.top && null == this.bottom && null == this.left && null == this.right && null == this.diagonal;\n  };\n\n  return WorkbookBorder;\n}();\n\nexport { WorkbookBorder };\n\nvar WorkbookBorderSetting = function () {\n  function WorkbookBorderSetting() {}\n\n  WorkbookBorderSetting.prototype._serialize = function () {\n    var e;\n    if ((null == this.color || \"\" === this.color) && null == this.style) return null;\n    e = {};\n    this.color && (e.color = this.color);\n    null != this.style && (e.style = asEnum(this.style, BorderStyle, !1));\n    return e;\n  };\n\n  WorkbookBorderSetting.prototype._deserialize = function (e) {\n    if (null != e.color || null != e.style) {\n      this.color = e.color;\n      null != e.style && (this.style = asEnum(e.style, BorderStyle, !1));\n    }\n  };\n\n  return WorkbookBorderSetting;\n}();\n\nexport { WorkbookBorderSetting };\n\nvar DefinedName = function () {\n  function DefinedName() {}\n\n  DefinedName.prototype._serialize = function () {\n    var e;\n    if (null == this.name) return null;\n    e = {\n      name: this.name,\n      value: this.value\n    };\n    null != this.sheetName && (e.sheetName = this.sheetName);\n    return e;\n  };\n\n  DefinedName.prototype._deserialize = function (e) {\n    this.name = e.name;\n    this.value = e.value;\n    this.sheetName = e.sheetName;\n  };\n\n  return DefinedName;\n}();\n\nexport { DefinedName };\n\nvar WorkbookTable = function () {\n  function WorkbookTable() {}\n\n  Object.defineProperty(WorkbookTable.prototype, \"columns\", {\n    get: function get() {\n      null == this._columns && (this._columns = []);\n      return this._columns;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n\n  WorkbookTable.prototype._serialize = function () {\n    var e, t;\n    if (null == this.name || null == this.range || null == this._columns) return null;\n    null != this.style && (t = this.style._serialize());\n    (e = {\n      name: this.name,\n      range: this.range,\n      showHeaderRow: this.showHeaderRow,\n      showTotalRow: this.showTotalRow,\n      style: t,\n      showBandedColumns: this.showBandedColumns,\n      showBandedRows: this.showBandedRows,\n      alterFirstColumn: this.alterFirstColumn,\n      alterLastColumn: this.alterLastColumn,\n      columns: []\n    }).columns = this._serializeTableColumns();\n    return e;\n  };\n\n  WorkbookTable.prototype._deserialize = function (e) {\n    var t;\n    this.name = e.name;\n    this.range = e.range;\n    this.showHeaderRow = e.showHeaderRow;\n    this.showTotalRow = e.showTotalRow;\n\n    if (null != e.style) {\n      (t = new WorkbookTableStyle())._deserialize(e.style);\n\n      this.style = t;\n    }\n\n    this.showBandedColumns = e.showBandedColumns;\n    this.showBandedRows = e.showBandedRows;\n    this.alterFirstColumn = e.alterFirstColumn;\n    this.alterLastColumn = e.alterLastColumn;\n\n    this._deserializeTableColumns(e.columns);\n  };\n\n  WorkbookTable.prototype._serializeTableColumns = function () {\n    var e,\n        t,\n        o = [];\n\n    for (t = 0; t < this._columns.length; t++) {\n      (e = this._columns[t]) && (o[t] = e._serialize());\n    }\n\n    return o;\n  };\n\n  WorkbookTable.prototype._deserializeTableColumns = function (e) {\n    var t, o, r;\n    assert(null != e, \"table Columns should not be null.\");\n    this._columns = [];\n\n    for (r = 0; r < e.length; r++) {\n      if (o = e[r]) {\n        (t = new WorkbookTableColumn())._deserialize(o);\n\n        this._columns[r] = t;\n      }\n    }\n  };\n\n  return WorkbookTable;\n}();\n\nexport { WorkbookTable };\n\nvar WorkbookTableColumn = function () {\n  function WorkbookTableColumn() {}\n\n  WorkbookTableColumn.prototype._serialize = function () {\n    return null == this.name ? null : {\n      name: this.name,\n      totalRowLabel: this.totalRowLabel,\n      totalRowFunction: this.totalRowFunction,\n      showFilterButton: this.showFilterButton\n    };\n  };\n\n  WorkbookTableColumn.prototype._deserialize = function (e) {\n    this.name = e.name;\n    this.totalRowLabel = e.totalRowLabel;\n    this.totalRowFunction = e.totalRowFunction;\n    this.showFilterButton = e.showFilterButton;\n  };\n\n  return WorkbookTableColumn;\n}();\n\nexport { WorkbookTableColumn };\n\nvar WorkbookTableStyle = function () {\n  function WorkbookTableStyle() {}\n\n  WorkbookTableStyle.prototype._serialize = function () {\n    var e;\n    if (this._checkEmptyWorkbookTableStyle()) return null;\n    e = {\n      name: this.name\n    };\n    this.wholeTableStyle && (e.wholeTableStyle = this.wholeTableStyle._serialize());\n    this.firstBandedColumnStyle && (e.firstBandedColumnStyle = this.firstBandedColumnStyle._serialize());\n    this.firstBandedRowStyle && (e.firstBandedRowStyle = this.firstBandedRowStyle._serialize());\n    this.secondBandedColumnStyle && (e.secondBandedColumnStyle = this.secondBandedColumnStyle._serialize());\n    this.secondBandedRowStyle && (e.secondBandedRowStyle = this.secondBandedRowStyle._serialize());\n    this.headerRowStyle && (e.headerRowStyle = this.headerRowStyle._serialize());\n    this.totalRowStyle && (e.totalRowStyle = this.totalRowStyle._serialize());\n    this.firstColumnStyle && (e.firstColumnStyle = this.firstColumnStyle._serialize());\n    this.lastColumnStyle && (e.lastColumnStyle = this.lastColumnStyle._serialize());\n    this.firstHeaderCellStyle && (e.firstHeaderCellStyle = this.firstHeaderCellStyle._serialize());\n    this.lastHeaderCellStyle && (e.lastHeaderCellStyle = this.lastHeaderCellStyle._serialize());\n    this.firstTotalCellStyle && (e.firstTotalCellStyle = this.firstTotalCellStyle._serialize());\n    this.lastTotalCellStyle && (e.lastTotalCellStyle = this.lastTotalCellStyle._serialize());\n    return e;\n  };\n\n  WorkbookTableStyle.prototype._deserialize = function (e) {\n    this.name = e.name;\n\n    if (e.wholeTableStyle) {\n      this.wholeTableStyle = new WorkbookTableCommonStyle();\n\n      this.wholeTableStyle._deserialize(e.wholeTableStyle);\n    }\n\n    if (e.firstBandedColumnStyle) {\n      this.firstBandedColumnStyle = new WorkbookTableBandedStyle();\n\n      this.firstBandedColumnStyle._deserialize(e.firstBandedColumnStyle);\n    }\n\n    if (e.firstBandedRowStyle) {\n      this.firstBandedRowStyle = new WorkbookTableBandedStyle();\n\n      this.firstBandedRowStyle._deserialize(e.firstBandedRowStyle);\n    }\n\n    if (e.secondBandedColumnStyle) {\n      this.secondBandedColumnStyle = new WorkbookTableBandedStyle();\n\n      this.secondBandedColumnStyle._deserialize(e.secondBandedColumnStyle);\n    }\n\n    if (e.secondBandedRowStyle) {\n      this.secondBandedRowStyle = new WorkbookTableBandedStyle();\n\n      this.secondBandedRowStyle._deserialize(e.secondBandedRowStyle);\n    }\n\n    if (e.headerRowStyle) {\n      this.headerRowStyle = new WorkbookTableCommonStyle();\n\n      this.headerRowStyle._deserialize(e.headerRowStyle);\n    }\n\n    if (e.totalRowStyle) {\n      this.totalRowStyle = new WorkbookTableCommonStyle();\n\n      this.totalRowStyle._deserialize(e.totalRowStyle);\n    }\n\n    if (e.firstColumnStyle) {\n      this.firstColumnStyle = new WorkbookTableCommonStyle();\n\n      this.firstColumnStyle._deserialize(e.firstColumnStyle);\n    }\n\n    if (e.lastColumnStyle) {\n      this.lastColumnStyle = new WorkbookTableCommonStyle();\n\n      this.lastColumnStyle._deserialize(e.lastColumnStyle);\n    }\n\n    if (e.firstHeaderCellStyle) {\n      this.firstHeaderCellStyle = new WorkbookTableCommonStyle();\n\n      this.firstHeaderCellStyle._deserialize(e.firstHeaderCellStyle);\n    }\n\n    if (e.lastHeaderCellStyle) {\n      this.lastHeaderCellStyle = new WorkbookTableCommonStyle();\n\n      this.lastHeaderCellStyle._deserialize(e.lastHeaderCellStyle);\n    }\n\n    if (e.firstTotalCellStyle) {\n      this.firstTotalCellStyle = new WorkbookTableCommonStyle();\n\n      this.firstTotalCellStyle._deserialize(e.firstTotalCellStyle);\n    }\n\n    if (e.lastTotalCellStyle) {\n      this.lastTotalCellStyle = new WorkbookTableCommonStyle();\n\n      this.lastTotalCellStyle._deserialize(e.lastTotalCellStyle);\n    }\n  };\n\n  WorkbookTableStyle.prototype._checkEmptyWorkbookTableStyle = function () {\n    return null == this.name || null == this.wholeTableStyle && null == this.firstBandedColumnStyle && null == this.firstBandedRowStyle && null == this.secondBandedColumnStyle && null == this.secondBandedRowStyle && null == this.headerRowStyle && null == this.totalRowStyle && null == this.firstColumnStyle && null == this.lastColumnStyle && null == this.firstHeaderCellStyle && null == this.lastHeaderCellStyle && null == this.firstTotalCellStyle && null == this.lastTotalCellStyle;\n  };\n\n  return WorkbookTableStyle;\n}();\n\nexport { WorkbookTableStyle };\n\nvar WorkbookTableCommonStyle = function (e) {\n  __extends(WorkbookTableCommonStyle, e);\n\n  function WorkbookTableCommonStyle() {\n    return e.call(this) || this;\n  }\n\n  WorkbookTableCommonStyle.prototype._deserialize = function (t) {\n    var o;\n\n    e.prototype._deserialize.call(this, t);\n\n    if (t.borders) {\n      (o = new WorkbookTableBorder())._deserialize(t.borders);\n\n      this.borders = o;\n    }\n  };\n\n  return WorkbookTableCommonStyle;\n}(WorkbookStyle);\n\nexport { WorkbookTableCommonStyle };\n\nvar WorkbookTableBandedStyle = function (e) {\n  __extends(WorkbookTableBandedStyle, e);\n\n  function WorkbookTableBandedStyle() {\n    return e.call(this) || this;\n  }\n\n  WorkbookTableBandedStyle.prototype._serialize = function () {\n    var t;\n    (t = e.prototype._serialize.call(this)).size = this.size;\n    return t;\n  };\n\n  WorkbookTableBandedStyle.prototype._deserialize = function (t) {\n    e.prototype._deserialize.call(this, t);\n\n    null != t.size && (this.size = t.size);\n  };\n\n  return WorkbookTableBandedStyle;\n}(WorkbookTableCommonStyle);\n\nexport { WorkbookTableBandedStyle };\n\nvar WorkbookTableBorder = function (e) {\n  __extends(WorkbookTableBorder, e);\n\n  function WorkbookTableBorder() {\n    return e.call(this) || this;\n  }\n\n  WorkbookTableBorder.prototype._serialize = function () {\n    var t;\n    null != (t = e.prototype._serialize.call(this)) || this.vertical && this.horizontal || (t = {});\n    this.vertical && (t.vertical = this.vertical._serialize());\n    this.horizontal && (t.horizontal = this.horizontal._serialize());\n    return t;\n  };\n\n  WorkbookTableBorder.prototype._deserialize = function (t) {\n    var o, r;\n\n    e.prototype._deserialize.call(this, t);\n\n    if (t.vertical) {\n      (o = new WorkbookBorderSetting())._deserialize(t.vertical);\n\n      this.vertical = o;\n    }\n\n    if (t.horizontal) {\n      (r = new WorkbookBorderSetting())._deserialize(t.horizontal);\n\n      this.horizontal = r;\n    }\n  };\n\n  return WorkbookTableBorder;\n}(WorkbookBorder);\n\nexport { WorkbookTableBorder };\n\nvar WorkbookTextRun = function () {\n  function WorkbookTextRun() {}\n\n  WorkbookTextRun.prototype._serialize = function () {\n    var e = {\n      text: this.text\n    };\n    this.font && (e.font = this.font._serialize());\n    return e;\n  };\n\n  WorkbookTextRun.prototype._deserialize = function (e) {\n    if (e.font) {\n      this.font = new WorkbookFont();\n\n      this.font._deserialize(e.font);\n    }\n\n    this.text = e.text;\n  };\n\n  return WorkbookTextRun;\n}();\n\nexport { WorkbookTextRun };\n\nvar _Base64 = function () {\n  function _Base64() {}\n\n  _Base64.toArray = function (e) {\n    for (var t = atob(e), o = t.length, r = new Uint8Array(o), l = 0; l < o; l++) {\n      r[l] = t.charCodeAt(l);\n    }\n\n    return r;\n  };\n\n  return _Base64;\n}(),\n    _TextRunsSerializer = function () {\n  function _TextRunsSerializer() {}\n\n  _TextRunsSerializer.deserialize = function (e) {\n    return e && e.length ? e.map(function (e) {\n      var t = new WorkbookTextRun();\n\n      t._deserialize(e);\n\n      return t;\n    }) : null;\n  };\n\n  _TextRunsSerializer.serialize = function (e) {\n    return e && e.length ? e.map(function (e) {\n      return e._serialize();\n    }) : null;\n  };\n\n  return _TextRunsSerializer;\n}();\n\nexport var HAlign;\n!function (e) {\n  e[e.General = 0] = \"General\";\n  e[e.Left = 1] = \"Left\";\n  e[e.Center = 2] = \"Center\";\n  e[e.Right = 3] = \"Right\";\n  e[e.Fill = 4] = \"Fill\";\n  e[e.Justify = 5] = \"Justify\";\n}(HAlign || (HAlign = {}));\nexport var VAlign;\n!function (e) {\n  e[e.Top = 0] = \"Top\";\n  e[e.Center = 1] = \"Center\";\n  e[e.Bottom = 2] = \"Bottom\";\n  e[e.Justify = 3] = \"Justify\";\n}(VAlign || (VAlign = {}));\nexport var TextDirection;\n!function (e) {\n  e[e.Context = 0] = \"Context\";\n  e[e.LeftToRight = 1] = \"LeftToRight\";\n  e[e.RightToLeft = 2] = \"RightToLeft\";\n}(TextDirection || (TextDirection = {}));\nexport var TextOrientation;\n!function (e) {\n  e[e.Horizontal = 0] = \"Horizontal\";\n  e[e.Vertical = 1] = \"Vertical\";\n  e[e.RotateUp = 2] = \"RotateUp\";\n  e[e.RotateDown = 3] = \"RotateDown\";\n}(TextOrientation || (TextOrientation = {}));\nexport var BorderStyle;\n!function (e) {\n  e[e.None = 0] = \"None\";\n  e[e.Thin = 1] = \"Thin\";\n  e[e.Medium = 2] = \"Medium\";\n  e[e.Dashed = 3] = \"Dashed\";\n  e[e.Dotted = 4] = \"Dotted\";\n  e[e.Thick = 5] = \"Thick\";\n  e[e.Double = 6] = \"Double\";\n  e[e.Hair = 7] = \"Hair\";\n  e[e.MediumDashed = 8] = \"MediumDashed\";\n  e[e.ThinDashDotted = 9] = \"ThinDashDotted\";\n  e[e.MediumDashDotted = 10] = \"MediumDashDotted\";\n  e[e.ThinDashDotDotted = 11] = \"ThinDashDotDotted\";\n  e[e.MediumDashDotDotted = 12] = \"MediumDashDotDotted\";\n  e[e.SlantedMediumDashDotted = 13] = \"SlantedMediumDashDotted\";\n}(BorderStyle || (BorderStyle = {}));\nvar JSZip = JSZipRef;\nexport function useJSZip(e) {\n  JSZip = e;\n}\n\nvar _xlsx = function () {\n  function _xlsx() {}\n\n  _xlsx.load = function (e) {\n    var t = new JSZip();\n    assert(null == t.loadAsync, \"Please use JSZip 2.5 to load excel files synchronously.\");\n    var o,\n        r = new _JsZipWrapper(t);\n\n    this._loadImpl(r, e).then(function (e) {\n      return o = e;\n    });\n\n    return o;\n  };\n\n  _xlsx.loadAsync = function (e) {\n    var t = new JSZip();\n    assert(null != t.loadAsync, \"Please use JSZip 3.0 to load excel files asynchrounously.\");\n    return this._loadImpl(t, e);\n  };\n\n  _xlsx.save = function (e) {\n    var t,\n        o = Date.now();\n\n    this._saveWorkbookToZip(e, null, !1).then(function (e) {\n      return t = e;\n    });\n\n    o = Date.now() - o;\n    var r = \"\";\n    r = this._macroEnabled ? \"application/vnd.ms-excel.sheet.macroEnabled.12;\" : \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;\";\n    var l = Date.now(),\n        i = t.generate({\n      compression: \"DEFLATE\"\n    });\n    return {\n      base64: i,\n      zipTime: Date.now() - l,\n      processTime: o,\n      href: function href() {\n        return \"data:\" + r + \"base64,\" + i;\n      }\n    };\n  };\n\n  _xlsx.saveAsync = function (e, t, o, r) {\n    var l = new _SyncPromise(t);\n    isFunction(r) && r(0);\n\n    this._saveWorkbookToZip(e, t, !0, function (e) {\n      isFunction(r) && r(Math.round(_map(e, 0, 100, 0, 90)));\n    }).then(function (e) {\n      isFunction(r) && r(91);\n      var i = e.generateAsync({\n        type: \"base64\",\n        compression: \"DEFLATE\"\n      });\n      i.catch(function (e) {\n        o && o(e);\n        l.reject(e);\n      });\n      i.then(function (e) {\n        if (t && t.cancelled) l.cancel();else {\n          isFunction(r) && r(100);\n          l.resolve(e);\n        }\n      });\n    }, function (e) {\n      l.reject(e);\n    });\n\n    return l;\n  };\n\n  _xlsx._loadImpl = function (e, t) {\n    var o,\n        r = this,\n        l = this,\n        i = Date.now(),\n        s = {\n      sheets: []\n    },\n        n = e.loadAsync(t, {\n      base64: isString(t)\n    }).then(function (e) {\n      return o = e;\n    });\n    t = null;\n    var a = n.constructor;\n    return (n = (n = (n = (n = (n = (n = (n = (n = n.then(function () {\n      var e = o.file(\"xl/theme/theme1.xml\");\n      if (e) return e.async(\"string\").then(function (e) {\n        l._getTheme(e);\n\n        s.colorThemes = l._colorThemes;\n      });\n    })).then(function () {\n      var e = o.file(\"xl/styles.xml\");\n      if (e) return e.async(\"string\").then(function (e) {\n        l._getStyle(e);\n\n        s.styles = l._styles;\n        null != l._tableStyles && (s.tableStyles = l._tableStyles);\n      });\n    })).then(function () {\n      var e = o.file(\"xl/sharedStrings.xml\");\n      if (e) return e.async(\"string\").then(function (e) {\n        l._getSharedString(e);\n      });\n    })).then(function () {\n      var e = o.file(\"xl/workbook.xml\");\n      if (e) return e.async(\"string\").then(function (e) {\n        l._getWorkbook(e, s);\n      });\n    })).then(function () {\n      l._tables = null;\n      var e = a.resolve();\n      o.folder(\"xl/tables\").forEach(function (t, o) {\n        null == l._tables && (l._tables = []);\n        e = e.then(function () {\n          return o.async(\"string\").then(function (e) {\n            var t = l._getTable(e);\n\n            t.fileName = o.name.substring(o.name.lastIndexOf(\"/\") + 1);\n\n            l._tables.push(t);\n          });\n        });\n      });\n      return e;\n    })).then(function () {\n      var e = o.file(\"docProps/core.xml\");\n      if (e) return e.async(\"string\").then(function (e) {\n        l._getCoreSetting(e, s);\n      });\n    })).then(function () {\n      var e = o.file(\"xl/vbaProject.bin\");\n      if (e) return e.async(\"uint8array\").then(function (e) {\n        null == s.reservedContent && (s.reservedContent = {});\n        s.reservedContent.macros = e;\n      });\n    })).then(function () {\n      var e = a.resolve();\n      o.folder(\"xl/worksheets\").forEach(function (t, r) {\n        if (t && -1 === t.indexOf(\"/\")) {\n          var i = l._getSheetIndex(r.name);\n\n          isNaN(i) || (e = e.then(function () {\n            return r.async(\"string\").then(function (e) {\n              l._getSheet(e, i - 1, s);\n\n              var t = o.file(\"xl/worksheets/_rels/sheet\" + i + \".xml.rels\");\n              if (t) return t.async(\"string\").then(function (e) {\n                for (var t, r, n = e.split(\"<Relationship \"), h = n.length; --h;) {\n                  var f = n[h],\n                      u = l._getAttr(f, \"Id\");\n\n                  if (s.sheets[i - 1].tableRIds && -1 !== s.sheets[i - 1].tableRIds.indexOf(u)) {\n                    null == s.sheets[i - 1].tables && (s.sheets[i - 1].tables = []);\n                    s.sheets[i - 1].tables.push(l._getSheetRelatedTable(f));\n                  } else if (s.sheets[i - 1].hyperlinkRIds) l._getSheetRelatedHyperlink(f, u, s.sheets[i - 1]);else {\n                    var c = l._getAttr(f, \"Type\");\n\n                    /\\/comments$/.test(c) ? t = {\n                      id: l._getAttr(f, \"Id\"),\n                      target: l._getAttr(f, \"Target\")\n                    } : /\\/vmlDrawing$/.test(c) && (r = {\n                      id: l._getAttr(f, \"Id\"),\n                      target: l._getAttr(f, \"Target\")\n                    });\n                  }\n                }\n\n                if (t && r) return function (e) {\n                  var i = a.resolve();\n                  return l._readNotes(e, t, r, o, i).then(function () {});\n                }(s.sheets[i - 1]);\n              });\n            });\n          }));\n        }\n      });\n      return e;\n    })).then(function () {\n      s.processTime = Date.now() - i;\n      o = null;\n      r._sharedStrings = null;\n      r._colorThemes = null;\n      r._styles = null;\n      r._sharedFormulas = null;\n      r._borders = null;\n      r._fonts = null;\n      r._fills = null;\n      r._contentTypes = null;\n      r._props = null;\n      r._xlRels = null;\n      r._worksheets = null;\n      r._tableStyles = null;\n      r._dxfs = null;\n      r._tables = null;\n      r._notes = null;\n      return s;\n    });\n  };\n\n  _xlsx._readNotes = function (e, t, o, r, l) {\n    var i = this,\n        absPath = function absPath(e) {\n      return e && e.replace(/^..\\//, \"xl/\");\n    },\n        s = r.file(absPath(t.target));\n\n    s && (l = l.then(function () {\n      return s.async(\"string\").then(function (t) {\n        for (var l = t.substring(t.indexOf(\"<authors>\"), t.indexOf(\"</authors>\")).split(\"<author>\"), s = [], n = 1; n < l.length; n++) {\n          s.push(l[n].substring(0, l[n].indexOf(\"</author>\")));\n        }\n\n        l = t.substring(t.indexOf(\"<commentList>\"), t.indexOf(\"</commentList>\")).split(\"<comment \");\n\n        for (n = 1; n < l.length; n++) {\n          var a = _xlsx._getAttr(l[n], \"ref\"),\n              h = i._alphaNum(a.match(/[a-zA-Z]*/g)[0]),\n              f = +a.match(/\\d*/g).join(\"\") - 1,\n              u = l[n],\n              c = u.substring(u.indexOf(\"<text>\") + \"<text>\".length, u.lastIndexOf(\"</text>\")),\n              d = i._extractTextRuns(c),\n              m = e.rows[f].cells[h];\n\n          null == m && (e.rows[f].cells[h] = m = {});\n          m.note = {\n            author: s[_xlsx._getAttr(u, \"authorId\")],\n            textRuns: d,\n            text: i._getTextOfTextRuns(d)\n          };\n        }\n\n        var p = r.file(absPath(o.target));\n        if (p) return p.async(\"string\").then(function (t) {\n          var o = {};\n          t.substring(0, t.indexOf(\">\")).split(\"xmlns:\").forEach(function (e) {\n            e.indexOf(\"vml\") >= 0 ? o.vml = e.substring(0, e.indexOf(\"=\")) : e.indexOf(\"office:office\") >= 0 ? o.office = e.substring(0, e.indexOf(\"=\")) : e.indexOf(\"office:excel\") >= 0 && (o.excel = e.substring(0, e.indexOf(\"=\")));\n          });\n\n          for (var r = t.split(\"<\" + o.vml + \":shape \"), l = new _NotePositionConverter(e), s = 1; s < r.length; s++) {\n            var n = r[s],\n                a = o.excel + \":ClientData\",\n                h = n.indexOf(a);\n\n            if (h > 0) {\n              h += a.length + 1;\n              var f = n.substring(h, n.indexOf(\"</\" + a, h));\n\n              if (\"Note\" === i._getAttr(f, \"ObjectType\")) {\n                var u = +i._getElementValue(f, o.excel + \":Row\", null, null),\n                    c = +i._getElementValue(f, o.excel + \":Column\", null, null),\n                    d = e.rows[u].cells[c].note;\n                assert(null != d, \"No related note was found, row=${row}, col=${col}.\");\n                d.visible = i._getElementValue(f, o.excel + \":Visible\", !1, !0);\n\n                var m = i._getElementValue(f, o.excel + \":Anchor\", null, null).split(\",\").map(function (e) {\n                  return parseFloat(e);\n                });\n\n                l.fromAnchor(m, d, u, c);\n              }\n            }\n          }\n\n          o = null;\n        });\n      });\n    }));\n    return l;\n  };\n\n  _xlsx._saveWorkbookToZip = function (e, t, o, r) {\n    var l = this,\n        i = new JSZip();\n    o ? assert(null != i.generateAsync, \"Please use JSZip 3.0 to save excel files asynchrounously.\") : assert(null == i.generateAsync, \"Please use JSZip 2.5 to save excel files synchronously.\");\n    isFunction(r) && r(0);\n    i.folder(\"_rels\").file(\".rels\", this._xmlDescription + this._generateRelsDoc());\n    var s = i.folder(\"docProps\"),\n        n = i.folder(\"xl\");\n    this._colorThemes = e.colorThemes;\n    n.folder(\"theme\").file(\"theme1.xml\", this._xmlDescription + this._generateThemeDoc());\n    this._macroEnabled = !(!e.reservedContent || !e.reservedContent.macros);\n    this._macroEnabled && n.file(\"vbaProject.bin\", e.reservedContent.macros);\n    s.file(\"core.xml\", this._xmlDescription + this._generateCoreDoc(e));\n    this._sharedStrings = [[], 0];\n    this._styles = new Array(1);\n    this._borders = new Array(1);\n    this._fonts = new Array(1);\n    this._fills = new Array(2);\n    this._tableStyles = new Array();\n    this._dxfs = new Array();\n    this._contentTypes = [];\n    this._props = [];\n    this._xlRels = [];\n    this._worksheets = [];\n    this._tables = [];\n    this._tableStyles = [];\n    this._notes = {};\n    var a = new _SyncPromise(t);\n\n    this._generateWorksheets(e, n, t, o, r).then(function () {\n      l._writeNotes(e.sheets, n);\n\n      n.file(\"styles.xml\", l._xmlDescription + l._generateStyleDoc());\n      i.file(\"[Content_Types].xml\", l._xmlDescription + l._generateContentTypesDoc(e));\n      s.file(\"app.xml\", l._xmlDescription + l._generateAppDoc(e));\n      n.folder(\"_rels\").file(\"workbook.xml.rels\", l._xmlDescription + l._generateWorkbookRels());\n\n      var t = l._xmlDescription + l._generateSharedStringsDoc();\n\n      l._sharedStrings = [[], 0];\n      n.file(\"sharedStrings.xml\", t);\n      t = null;\n      n.file(\"workbook.xml\", l._xmlDescription + l._generateWorkbook(e));\n      isFunction(r) && r(100);\n      a.resolve(i);\n    });\n\n    return a;\n  };\n\n  _xlsx._writeNotes = function (e, t) {\n    var o = this;\n    e.forEach(function (e, r) {\n      var l = o._notes[r];\n\n      if (l) {\n        t.folder(\"drawings\").file(\"vmlDrawing\" + (r + 1) + \".vml\", function (e) {\n          var t = '<xml xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:x=\"urn:schemas-microsoft-com:office:excel\">\\r\\n';\n          t += '<o:shapelayout v:ext=\"edit\">\\r\\n';\n          t += '<o:idmap v:ext=\"edit\" data=\"1\"/>\\r\\n';\n          t += \"</o:shapelayout>\\r\\n\";\n          t += '<v:shapetype id=\"_x0000_t202\" coordsize=\"21600,21600\" o:spt=\"202\" path=\"m,l,21600r21600,l21600,xe\">\\r\\n';\n          t += '<v:stroke joinstyle=\"miter\"/>\\r\\n';\n          t += '<v:path gradientshapeok=\"t\" o:connecttype=\"rect\"/>\\r\\n';\n          t += \"</v:shapetype>\\r\\n\";\n          var o = 1e3 * (r + 1) + 50,\n              i = new _NotePositionConverter(e);\n          l.forEach(function (e, r) {\n            assert(e._row >= 0 && e._col >= 0, \"Invalid cell's indicies.\");\n            var l = null == e.visible || !0 === e.visible;\n            t += '<v:shape id=\"_x0000_s' + o++ + '\" type=\"#_x0000_t202\" style=\\'' + (\"position:absolute; visibility:\" + (l ? \"visible\" : \"hidden\") + \"; z-index:\" + (r + 1) + \";\") + '\\' fillcolor=\"infoBackground [80]\" o:insetmode=\"auto\">\\r\\n';\n            t += '<v:fill color2=\"infoBackground [80]\"/>\\r\\n';\n            t += '<v:shadow color=\"none [81]\" obscured=\"t\"/>\\r\\n';\n            t += '<v:path o:connecttype=\"none\"/>\\r\\n';\n            \"text-align:left;\";\n            \"mso-direction-alt:auto;\";\n            t += '<v:textbox style=\"mso-direction-alt:auto;\" ';\n            t += \">\\r\\n\";\n            t += '<div style=\"text-align:left;\"></div>\\r\\n';\n            t += \"</v:textbox>\\r\\n\";\n            t += '<x:ClientData ObjectType=\"Note\">\\r\\n';\n            t += \"<x:MoveWithCells/>\\r\\n\";\n            t += \"<x:SizeWithCells/>\\r\\n\";\n            null == e.width && (e.width = 144);\n            null == e.height && (e.height = 79);\n            null == e.offsetX && (e.offsetX = 15);\n            null == e.offsetY && (e.offsetY = 0 == e._row ? 2 : 15);\n            var s = i.toAnchor(e, e._row, e._col);\n            t += \"<x:Anchor>\" + s.toString() + \"</x:Anchor>\\r\\n\";\n            t += \"<x:AutoFill>False</x:AutoFill>\\r\\n\";\n            t += \"<x:Row>\" + e._row + \"</x:Row>\\r\\n\";\n            t += \"<x:Column>\" + e._col + \"</x:Column>\\r\\n\";\n            l && (t += \"<x:Visible/>\\r\\n\");\n            t += \"</x:ClientData>\\r\\n\";\n            t += \"</v:shape>\\r\\n\";\n          });\n          return t + \"</xml>\";\n        }(e));\n        t.file(\"comments\" + (r + 1) + \".xml\", function (e) {\n          var t = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n';\n          t += '<comments xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"xr\" xmlns:xr=\"http://schemas.microsoft.com/office/spreadsheetml/2014/revision\">\\r\\n';\n          var r = {},\n              i = [],\n              s = {\n            family: \"Tahoma\",\n            size: 12\n          };\n          l.forEach(function (e) {\n            var t = e.author || \"\";\n\n            if (null == r[t]) {\n              r[t] = i.length;\n              i.push(t);\n            }\n          });\n          t += \"<authors>\\r\\n\";\n          i.forEach(function (e) {\n            return t += \"<author>\" + e + \"</author>\\r\\n\";\n          });\n          t += \"</authors>\\r\\n\";\n          t += \"<commentList>\\r\\n\";\n          l.forEach(function (e) {\n            var l = o._numAlpha(e._col) + (e._row + 1);\n            t += '<comment ref=\"' + l + '\" authorId=\"' + r[e.author || \"\"] + '\" shapeId=\"0\" xr:uid=\"' + _guid() + '\">\\r\\n';\n            t += \"<text>\\r\\n\";\n            var i = e.textRuns && e.textRuns.length ? e.textRuns : [{\n              text: e.text\n            }];\n            i = i.map(function (e) {\n              e.font = e.font || s;\n              return e;\n            });\n            t += o._generateTextRuns(i, o._defaultFontName.toLowerCase());\n            t += \"</text>\";\n            t += \"</comment>\\r\\n\";\n          });\n          return (t += \"</commentList>\\r\\n\") + \"</comments>\";\n        }());\n      }\n    });\n  };\n\n  _xlsx._generateWorksheets = function (e, t, o, r, l) {\n    for (var i, s = this, n = t.folder(\"worksheets\"), a = e.sheets.length, h = [], f = e.sheets.map(function (e) {\n      return e.rows.length;\n    }).reduce(function (e, t) {\n      return e + t;\n    }), u = e.sheets.map(function (e) {\n      return e.rows.length / f;\n    }), c = a - 1, d = 0, m = 0, _loop_1 = function _loop_1() {\n      var f = a;\n      h.push(function () {\n        var a = new _SyncPromise(o);\n\n        s._generateWorkSheet(f, e, n, o, r, function (e) {\n          if (isFunction(l)) {\n            e = Math.round(e * u[f]);\n\n            if (c !== f) {\n              c = f;\n              m += d;\n            }\n\n            d = e;\n            l(m + e);\n          }\n        }).then(function () {\n          var o = e.sheets[f],\n              r = o && o.externalLinks,\n              l = s._sheetHasNotes(f);\n\n          if (o && (o.tables && o.tables.length > 0 || r && r.length > 0 || l)) {\n            var h = 1,\n                u = '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">';\n\n            if (l) {\n              u += '<Relationship Id=\"rId' + h++ + '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing\" Target=\"../drawings/vmlDrawing' + (f + 1) + '.vml\" />';\n              u += '<Relationship Id=\"rId' + h++ + '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments\" Target=\"../comments' + (f + 1) + '.xml\" />';\n            }\n\n            if (r && r.length > 0) {\n              u += s._generateHyperlinkRel(r, h);\n              h += r.length;\n            }\n\n            if (o.tables && o.tables.length > 0) {\n              null == i && (i = t.folder(\"tables\"));\n\n              for (var c = 0; c < o.tables.length; c++) {\n                var d = o.tables[c];\n\n                s._generateTable(d, i);\n\n                u += '<Relationship Target=\"../tables/' + d.fileName + '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table\" Id=\"rId' + (c + h) + '\"/>';\n              }\n            }\n\n            u += \"</Relationships>\";\n            n.folder(\"_rels\").file(\"sheet\" + (f + 1) + \".xml.rels\", s._xmlDescription + u);\n          }\n\n          a.resolve();\n        });\n\n        return a;\n      });\n    }; a--;) {\n      _loop_1();\n    }\n\n    return _SyncPromise.serial(o, h).then(function () {\n      isFunction(l) && l(100);\n    });\n  };\n\n  _xlsx._getSharedString = function (e) {\n    var t = e.split(/<si.*?>/g),\n        o = t.length;\n    this._sharedStrings = [];\n\n    for (; --o;) {\n      if (t[o].search(/<r>/gi) > -1) this._sharedStrings[o - 1] = this._extractTextRuns(t[o]);else {\n        var r = this._getElementValue(t[o], \"t\", \"\", \"\");\n\n        this._sharedStrings[o - 1] = Workbook._unescapeXML(r);\n      }\n    }\n  };\n\n  _xlsx._extractTextRuns = function (e) {\n    for (var t = [], o = e.split(/<r>/g), r = 1; r < o.length; r++) {\n      var l = void 0;\n      -1 !== o[r].indexOf(\"<rPr>\") && (l = this._getTextRunFont(o[r]));\n\n      var i = this._getElementValue(o[r], \"t\", \"\", \"\");\n\n      t.push({\n        font: l,\n        text: Workbook._unescapeXML(i)\n      });\n    }\n\n    return t;\n  };\n\n  _xlsx._getInlineString = function (e) {\n    for (var t = e.split(\"<t\"), o = t.length, r = \"\"; --o;) {\n      var l = t[o];\n\n      if (\" \" === l[0] || \">\" === l[0]) {\n        var i = l.indexOf(\"</t>\");\n        i > 0 && (r = l.substring(l.indexOf(\">\") + 1, i) + r);\n      }\n    }\n\n    return r;\n  };\n\n  _xlsx._convertDecimalEntities = function (e) {\n    if (isIE() && -1 !== e.indexOf(\"&#\")) return e.replace(/&#(\\d{1,7});/g, function (e, t) {\n      return fromCodePointImpl(t);\n    });\n\n    for (var t, o = 0, r = \"\"; (t = e.indexOf(\"&#\", o)) >= 0;) {\n      var l = e.indexOf(\";\", t + 2);\n      if (-1 === l) break;\n      var i = l - t - 2;\n\n      if (i > 0 && i < 8) {\n        var s = e.substr(t + 2, i),\n            n = +s;\n\n        if (n != s) {\n          r += e.substr(o, 2);\n          o += 2;\n          continue;\n        }\n\n        r += e.substring(o, t);\n        r += fromCodePointImpl(n);\n      } else r += e.substring(o, l + 1);\n\n      o = l + 1;\n    }\n\n    o !== e.length && (r += e.substr(o));\n    return r || e;\n  };\n\n  _xlsx._getCoreSetting = function (e, t) {\n    var o, r;\n\n    if ((r = e.indexOf(\"<dc:creator>\")) >= 0) {\n      o = e.substr(r + 12);\n      t.creator = o.substring(0, o.indexOf(\"</dc:creator>\"));\n    }\n\n    if ((r = e.indexOf(\"<cp:lastModifiedBy>\")) >= 0) {\n      o = e.substr(r + 19);\n      t.lastModifiedBy = o.substring(0, o.indexOf(\"</cp:lastModifiedBy>\"));\n    }\n\n    if ((r = e.indexOf('<dcterms:created xsi:type=\"dcterms:W3CDTF\">')) >= 0) {\n      o = e.substr(r + 43);\n      t.created = new Date(o.substring(0, o.indexOf(\"</dcterms:created>\")));\n    }\n\n    if ((r = e.indexOf('<dcterms:modified xsi:type=\"dcterms:W3CDTF\">')) >= 0) {\n      o = e.substr(r + 44);\n      t.modified = new Date(o.substring(0, o.indexOf(\"</dcterms:modified>\")));\n    }\n  };\n\n  _xlsx._getWorkbook = function (e, t) {\n    var o,\n        r,\n        l,\n        i,\n        s,\n        n,\n        a,\n        h,\n        f = e.substring(e.indexOf(\"<bookViews>\"), e.indexOf(\"</bookViews>\")),\n        u = \"\",\n        c = e.indexOf(\"<definedNames>\");\n    f && (u = this._getAttr(f, \"activeTab\"));\n    t.activeWorksheet = +u;\n    n = (s = e.split(\"<sheet \")).length;\n\n    for (; --n;) {\n      a = this._getAttr(s[n], \"name\");\n      h = \"hidden\" !== this._getAttr(s[n], \"state\");\n      t.sheets.unshift({\n        name: a,\n        visible: h,\n        columns: [],\n        rows: []\n      });\n    }\n\n    if (c > -1) {\n      t.definedNames = [];\n      n = (s = e.substring(c, e.indexOf(\"</definedNames>\")).split(\"<definedName \")).length;\n\n      for (; --n;) {\n        a = this._getAttr(s[n], \"name\");\n\n        if (r = s[n].match(/.*>.+(?=<\\/definedName>)/)) {\n          r = r[0].replace(/(.*>)(.+)/, \"$2\");\n          r = isNaN(+r) ? r : +r;\n        }\n\n        o = {\n          name: a,\n          value: r\n        };\n        \"\" !== (l = this._getAttr(s[n], \"localSheetId\")) && (i = t.sheets[+l]) && (o.sheetName = i.name);\n        t.definedNames.unshift(o);\n      }\n    }\n  };\n\n  _xlsx._getTheme = function (e) {\n    e = e.substring(e.indexOf(\"<a:clrScheme\"), e.indexOf(\"</a:clrScheme>\"));\n    this._colorThemes = this._defaultColorThemes.slice();\n    this._colorThemes[0] = this._getAttr(e.substring(e.indexOf(\"a:lt1\"), e.indexOf(\"</a:lt1>\")), \"lastClr\") || this._getAttr(e.substring(e.indexOf(\"a:lt1\"), e.indexOf(\"</a:lt1>\")), \"val\");\n    this._colorThemes[1] = this._getAttr(e.substring(e.indexOf(\"a:dk1\"), e.indexOf(\"</a:dk1>\")), \"lastClr\") || this._getAttr(e.substring(e.indexOf(\"a:dk1\"), e.indexOf(\"</a:dk1>\")), \"val\");\n    this._colorThemes[2] = this._getAttr(e.substring(e.indexOf(\"a:lt2\"), e.indexOf(\"</a:lt2>\")), \"val\");\n    this._colorThemes[3] = this._getAttr(e.substring(e.indexOf(\"a:dk2\"), e.indexOf(\"</a:dk2>\")), \"val\");\n\n    for (var t = e.substring(e.indexOf(\"<a:accent1\"), e.indexOf(\"</a:accent6>\")).split(\"<a:accent\"), o = t.length; --o;) {\n      this._colorThemes[o + 3] = this._getAttr(t[o], \"val\");\n    }\n  };\n\n  _xlsx._getStyle = function (e) {\n    var t = [],\n        o = [],\n        r = [],\n        l = this._numFmts.slice();\n\n    this._styles = [];\n    var i = e.indexOf(\"<numFmts\");\n    if (i >= 0) for (var s = e.substring(i + 8, e.indexOf(\"</numFmts>\")).split(\"<numFmt\"), n = s.length; --n;) {\n      var a = s[n];\n      l[+this._getAttr(a, \"numFmtId\")] = this._getAttr(a, \"formatCode\");\n    }\n\n    if ((i = e.indexOf(\"<fonts\")) >= 0) {\n      var h = e.substring(i, e.indexOf(\"</fonts>\")).split(\"<font>\");\n\n      for (n = h.length; --n;) {\n        a = h[n];\n\n        var f = this._getChildNodeValue(a, \"sz\"),\n            u = void 0;\n\n        t[n - 1] = {\n          bold: /<b\\s*\\/>/.test(a) || \"true\" === this._getChildNodeValue(a, \"b\"),\n          italic: /<i\\s*\\/>/.test(a) || \"true\" === this._getChildNodeValue(a, \"i\"),\n          underline: /<u\\s*\\/>/.test(a) || !!(u = this._getChildNodeValue(a, \"u\")) && \"none\" !== u,\n          size: Math.round(f ? 96 * +f / 72 : 14),\n          family: this._getChildNodeValue(a, \"name\"),\n          color: this._getColor(a, !1)\n        };\n        f = null;\n      }\n    }\n\n    if ((i = e.indexOf(\"<fills\")) >= 0) {\n      var c = e.substring(i, e.indexOf(\"</fills>\")).split(\"<fill>\");\n\n      for (n = c.length; --n;) {\n        o[n - 1] = this._getColor(c[n], !0);\n      }\n    }\n\n    if ((i = e.indexOf(\"<borders\")) >= 0) {\n      var d = e.substring(i + 8, e.indexOf(\"</borders>\")).split(\"<border\");\n\n      for (n = d.length; --n;) {\n        a = d[n];\n        r[n - 1] = {\n          left: this._getEdgeBorder(a, \"left\"),\n          right: this._getEdgeBorder(a, \"right\"),\n          top: this._getEdgeBorder(a, \"top\"),\n          bottom: this._getEdgeBorder(a, \"bottom\")\n        };\n      }\n    }\n\n    if ((i = e.indexOf(\"<cellXfs\")) >= 0) {\n      var m = e.substring(i, e.indexOf(\"</cellXfs>\")).split(\"<xf\");\n\n      for (n = m.length; --n;) {\n        a = m[n];\n        var p = +this._getAttr(a, \"numFmtId\"),\n            _ = l[p],\n            g = \"unknown\";\n        _ && (/[hsmy\\:]/i.test(_) ? g = \"date\" : _.indexOf(\"0\") > -1 ? g = \"number\" : \"@\" === _ && (g = \"string\"));\n        var b = (p = +this._getAttr(a, \"fontId\")) > 0 ? t[p] : null,\n            y = (p = +this._getAttr(a, \"fillId\")) > 1 ? o[p] : null,\n            x = (p = +this._getAttr(a, \"borderId\")) > 0 ? r[p] : null;\n        i = a.indexOf(\"<alignment\");\n\n        this._styles.unshift({\n          formatCode: _,\n          type: g,\n          font: b,\n          fillColor: y,\n          borders: x,\n          hAlign: i >= 0 ? Workbook._parseStringToHAlign(this._getAttr(a, \"horizontal\")) : null,\n          vAlign: i >= 0 ? Workbook._parseStringToVAlign(this._getAttr(a, \"vertical\")) : null,\n          wordWrap: i >= 0 ? \"1\" === this._getAttr(a, \"wrapText\") : null,\n          quotePrefix: 1 == +this._getAttr(a, \"quotePrefix\")\n        });\n      }\n    }\n\n    if (e.indexOf(\"<tableStyle \") > -1) {\n      this._tableStyles = [];\n      var k = e.substring(e.indexOf(\"<tableStyles \"), e.indexOf(\"</tableStyles>\")),\n          v = e.substring(e.indexOf(\"<dxfs \"), e.indexOf(\"</dxfs>\"));\n\n      this._getTableStyles(k, v.split(\"<dxf>\"));\n    }\n  };\n\n  _xlsx._getEdgeBorder = function (e, t) {\n    var o,\n        r,\n        l,\n        i,\n        s = e.indexOf(\"<\" + t),\n        n = e.indexOf(\"</\" + t + \">\");\n\n    if (s >= 0) {\n      r = e.substring(s);\n      r = n >= 0 ? r.substring(0, n) : r.substring(0, r.indexOf(\"/>\"));\n\n      var a = this._getAttr(r, \"style\");\n\n      if (a) {\n        l = Workbook._parseStringToBorderType(a);\n        i = this._getColor(r, !1);\n\n        if (l !== BorderStyle.Thin || !i || \"#c6c6c6\" !== i.toLowerCase()) {\n          (o = {}).style = l;\n          o.color = i;\n        }\n      }\n    }\n\n    return o;\n  };\n\n  _xlsx._getSheet = function (e, t, o) {\n    var r,\n        l = [];\n    if (e.indexOf(\"<mergeCells\") > -1) for (var i = e.substring(e.indexOf(\"<mergeCells\"), e.indexOf(\"</mergeCells>\")).split(\"<mergeCell \"), s = i.length; --s;) {\n      2 === (r = this._getAttr(i[s], \"ref\").split(\":\")).length && l.unshift({\n        topRow: +r[0].match(/\\d*/g).join(\"\") - 1,\n        leftCol: this._alphaNum(r[0].match(/[a-zA-Z]*/g)[0]),\n        bottomRow: +r[1].match(/\\d*/g).join(\"\") - 1,\n        rightCol: this._alphaNum(r[1].match(/[a-zA-Z]*/g)[0])\n      });\n    }\n\n    this._getsBaseSharedFormulas(e);\n\n    var n = e.split(\"<row \"),\n        a = o.sheets[t];\n\n    if (n[0].indexOf(\"<dimension\") >= 0) {\n      var h = this._getAttr(n[0].substr(n[0].indexOf(\"<dimension\")), \"ref\");\n\n      if (h) {\n        h = h.substr(h.indexOf(\":\") + 1);\n        a.maxCol = this._alphaNum(h.match(/[a-zA-Z]*/g)[0]) + 1;\n        a.maxRow = +h.match(/\\d*/g).join(\"\");\n      }\n    }\n\n    var f = e.indexOf(\"<tableParts\");\n\n    if (f > -1) {\n      var u = e.substring(f, e.indexOf(\"</tableParts>\")).split(\"<tablePart \"),\n          c = u.length;\n      a.tableRIds = [];\n\n      for (; --c;) {\n        a.tableRIds.unshift(this._getAttr(u[c], \"r:id\"));\n      }\n    }\n\n    if (n.length > 0 && n[0].indexOf(\"<pane\") > -1 && \"frozen\" === this._getAttr(n[0].substr(n[0].indexOf(\"<pane\")), \"state\")) {\n      var d = this._getAttr(n[0].substr(n[0].indexOf(\"<pane\")), \"ySplit\"),\n          m = this._getAttr(n[0].substr(n[0].indexOf(\"<pane\")), \"xSplit\");\n\n      a.frozenPane = {\n        rows: d ? +d : NaN,\n        columns: m ? +m : NaN\n      };\n    }\n\n    a.summaryBelow = \"0\" !== this._getAttr(n[0], \"summaryBelow\");\n    s = n.length;\n\n    if (n.length <= 1) {\n      a.maxCol = 20;\n      a.maxRow = 200;\n    } else (null == a.maxRow || a.maxRow < s - 1) && (a.maxRow = s - 1);\n\n    for (var p, _ = null, g = null; --s;) {\n      var b = a.rows[+this._getAttr(n[s], \"r\") - 1] = {\n        visible: !0,\n        groupLevel: NaN,\n        cells: []\n      };\n      n[s].substring(0, n[s].indexOf(\">\")).indexOf(\"hidden\") > -1 && \"1\" === this._getAttr(n[s], \"hidden\") && (b.visible = !1);\n\n      if (\"1\" === this._getAttr(n[s], \"customHeight\")) {\n        var y = +this._getAttr(n[s].substring(0, n[s].indexOf(\">\")).replace(\"customHeight\", \"\"), \"ht\");\n        b.height = 96 * y / 72;\n      }\n\n      _ = null;\n      g = null;\n      \"1\" === this._getAttr(n[s], \"customFormat\") && (_ = (g = this._styles[+this._getAttr(n[s].substring(n[s].indexOf(\" s=\")), \"s\")] || {\n        type: \"General\",\n        formatCode: null\n      }).font || g.fillColor || g.hAlign || g.vAlign || g.wordWrap || g.borders || g.formatCode && \"General\" !== g.formatCode ? {\n        format: g.formatCode && \"General\" !== g.formatCode ? g.formatCode : null,\n        font: g.font,\n        fill: {\n          color: g.fillColor\n        },\n        borders: g.borders,\n        hAlign: g.hAlign,\n        vAlign: g.vAlign,\n        wordWrap: g.wordWrap\n      } : null);\n      b.style = _;\n\n      var x = this._getAttr(n[s], \"outlineLevel\");\n\n      b.groupLevel = x && \"\" !== x ? +x : NaN;\n      b.collapsed = \"1\" === this._getAttr(n[s], \"collapsed\");\n      var k = n[s].split(\"<c \"),\n          v = k.length;\n      (null == a.maxCol || a.maxCol < v - 1) && (a.maxCol = v - 1);\n\n      for (; --v;) {\n        var S = k[v];\n        _ = (g = this._styles[+this._getAttr(S, \"s\")] || {\n          type: \"General\",\n          formatCode: null\n        }).font || g.fillColor || g.hAlign || g.vAlign || g.wordWrap || g.borders || g.formatCode && \"General\" !== g.formatCode ? {\n          format: g.formatCode && \"General\" !== g.formatCode ? g.formatCode : null,\n          font: g.font,\n          fill: {\n            color: g.fillColor\n          },\n          borders: g.borders,\n          hAlign: g.hAlign,\n          vAlign: g.vAlign,\n          wordWrap: g.wordWrap\n        } : null;\n        var w = this._getAttr(S.substring(0, S.indexOf(\">\")), \"t\") || g.type,\n            C = null,\n            W = \"inlineStr\" === w || S.indexOf(\"<is>\") >= 0;\n\n        if (W) {\n          C = this._getInlineString(S);\n          C = this._convertDecimalEntities(C);\n        } else {\n          C = this._getElementValue(S, \"v\", \"\", \"\");\n          C = Workbook._unescapeXML(C);\n        }\n\n        var T = null,\n            F = null,\n            A = null;\n        if (S.indexOf(\"<f\") > -1) if (S.indexOf(\"</f>\") > -1) (T = S.match(/<f.*>.+(?=<\\/f>)/)) && (T = T[0].replace(/(\\<f.*>)(.+)/, \"$2\"));else if (F = this._getAttr(S, \"si\")) {\n          A = this._getAttr(S, \"r\");\n          T = this._getSharedFormula(F, A);\n        }\n        null != T && (T = T.replace(/\\[\\#This Row\\]\\s*,\\s*/gi, \"@\"));\n        \"str\" === w || \"e\" === w || W || (C = C ? +C : C);\n        p = this._alphaNum(this._getAttr(S, \"r\").match(/[a-zA-Z]*/g)[0]);\n        var z = null;\n\n        switch (w) {\n          case \"s\":\n            if (null != (C = this._sharedStrings[C])) if (isString(C)) g && g.quotePrefix && (C = \"'\" + C);else {\n              z = C.slice();\n              C = this._getTextOfTextRuns(z);\n            }\n            break;\n\n          case \"b\":\n            C = 1 === C;\n            break;\n\n          case \"date\":\n            C = C ? this._convertDate(C) : \"\";\n        }\n\n        if (isNumber(C)) {\n          null == _ && (_ = {\n            format: \"\"\n          });\n          isInt(C) ? _.format = _.format || \"#,##0\" : _.format = _.format || \"#,##0.00\";\n        }\n\n        b.cells[p] = {\n          value: C,\n          textRuns: z,\n          isDate: \"date\" === w,\n          isNumber: \"number\" === w,\n          formula: Workbook._unescapeXML(T),\n          style: _\n        };\n      }\n    }\n\n    var R = [],\n        N = [];\n    _ = null;\n    g = null;\n    if (n.length > 0 && n[0].indexOf(\"<cols>\") > -1) for (var O = (R = n[0].substring(n[0].indexOf(\"<cols>\") + 6, n[0].indexOf(\"</cols>\")).split(\"<col \")).length - 1; O > 0; O--) {\n      var D = this._parseCharWidthToPixel(+this._getAttr(R[O], \"width\"));\n\n      g = null;\n      R[O].indexOf(\"style\") > -1 && (g = this._styles[+this._getAttr(R[O], \"style\")] || {\n        type: \"General\",\n        formatCode: null\n      });\n      _ = null;\n      g && (g.font || g.fillColor || g.hAlign || g.vAlign || g.wordWrap || g.borders || g.formatCode && \"General\" !== g.formatCode) && (_ = {\n        format: g.formatCode && \"General\" !== g.formatCode ? g.formatCode : null,\n        font: g.font,\n        fill: {\n          color: g.fillColor\n        },\n        borders: g.borders,\n        hAlign: g.hAlign,\n        vAlign: g.vAlign,\n        wordWrap: g.wordWrap\n      });\n      var B = +this._getAttr(R[O], \"min\"),\n          P = +this._getAttr(R[O], \"max\");\n      if (P > a.maxCol) a._extraColumn = {\n        min: B,\n        max: P,\n        width: D,\n        style: _\n      };else for (p = B - 1; p < P && p < a.maxCol; p++) {\n        N[p] = {\n          visible: \"1\" !== this._getAttr(R[O], \"hidden\"),\n          autoWidth: \"1\" === this._getAttr(R[O], \"bestFit\"),\n          width: D,\n          style: _\n        };\n      }\n    }\n    a.columns = N;\n    var E,\n        I = e.indexOf(\"<hyperlinks\");\n    if (I > -1) for (var M = e.substring(I, e.indexOf(\"</hyperlinks>\")).split(\"<hyperlink \"), L = M.length; --L;) {\n      this._getHyperlink(a, M[L]);\n    }\n\n    if (a.frozenPane) {\n      if (!isNaN(a.frozenPane.rows)) for (s = 0; s < a.rows.length && s < a.frozenPane.rows; s++) {\n        a.rows[s] && !a.rows[s].visible && a.frozenPane.rows++;\n      }\n      if (!isNaN(a.frozenPane.columns)) for (s = 0; s < N.length && s < a.frozenPane.columns; s++) {\n        N[s] && !N[s].visible && a.frozenPane.columns++;\n      }\n    }\n\n    for (v = 0; v < l.length; v++) {\n      E = l[v];\n      a.rows[E.topRow] || (a.rows[E.topRow] = {\n        cells: []\n      });\n      a.rows[E.topRow].cells || (a.rows[E.topRow].cells = []);\n      a.rows[E.topRow].cells[E.leftCol] || (a.rows[E.topRow].cells[E.leftCol] = {});\n      a.rows[E.topRow].cells[E.leftCol].rowSpan = E.bottomRow < a.maxRow ? E.bottomRow - E.topRow + 1 : 200;\n      a.rows[E.topRow].cells[E.leftCol].colSpan = E.rightCol < a.maxCol ? E.rightCol - E.leftCol + 1 : 20;\n    }\n  };\n\n  _xlsx._getTable = function (e) {\n    var t = {};\n    t.name = this._getAttr(e, \"name\");\n    t.range = this._getAttr(e, \"ref\");\n\n    var o = this._getAttr(e, \"headerRowCount\");\n\n    t.showHeaderRow = \"\" == o || \"1\" === o;\n\n    var r = this._getAttr(e, \"totalsRowCount\");\n\n    t.showTotalRow = \"1\" === r;\n\n    var l = e.substring(e.indexOf(\"<tableStyleInfo\")),\n        i = this._getAttr(l, \"name\");\n\n    this._isBuiltInStyleName(i) ? t.style = {\n      name: i\n    } : t.style = this._getTableStyleByName(i);\n    t.showBandedColumns = \"1\" === this._getAttr(l, \"showColumnStripes\");\n    t.showBandedRows = \"1\" === this._getAttr(l, \"showRowStripes\");\n    t.alterFirstColumn = \"1\" === this._getAttr(l, \"showFirstColumn\");\n    t.alterLastColumn = \"1\" === this._getAttr(l, \"showLastColumn\");\n    var s = e.split(\"<tableColumn \");\n    t.columns = [];\n\n    for (var n = 1; n < s.length; n++) {\n      var a = s[n];\n      t.columns.push(this._getTableColumn(a));\n    }\n\n    if (e.indexOf(\"filterColumn\") > -1) for (var h = e.substring(e.indexOf(\"<autoFilter\"), e.indexOf(\"</autoFilter>\")).split(\"<filterColumn\"), f = 1; f < h.length; f++) {\n      var u = h[f],\n          c = +this._getAttr(u, \"colId\");\n      t.columns[c].showFilterButton = \"1\" !== this._getAttr(u, \"hiddenButton\");\n    }\n    return t;\n  };\n\n  _xlsx._getTableColumn = function (e) {\n    var t = {};\n    t.name = this._getAttr(e, \"name\");\n\n    var o = this._getAttr(e, \"totalsRowLabel\");\n\n    if (o) t.totalRowLabel = o;else {\n      var r = this._getAttr(e, \"totalsRowFunction\");\n\n      \"custom\" === r && (r = e.substring(e.indexOf(\"<totalsRowFormula>\") + 2 + \"totalsRowFormula\".length, e.indexOf(\"</totalsRowFormula>\")));\n      t.totalRowFunction = r;\n    }\n    return t;\n  };\n\n  _xlsx._getSheetRelatedTable = function (e) {\n    var t = this._getAttr(e, \"Target\");\n\n    t = t.substring(t.lastIndexOf(\"/\") + 1);\n\n    for (var o = 0; o < this._tables.length; o++) {\n      var r = this._tables[o];\n      if (t === r.fileName) return r;\n    }\n\n    return null;\n  };\n\n  _xlsx._getSheetRelatedHyperlink = function (e, t, o) {\n    for (var r = 0; r < o.hyperlinkRIds.length; r++) {\n      var l = o.hyperlinkRIds[r];\n\n      if (l.rId === t) {\n        var i = this._getAttr(e, \"Target\");\n\n        o.rows[l.ref.row] && o.rows[l.ref.row].cells[l.ref.col] && (o.rows[l.ref.row].cells[l.ref.col].link = i);\n      }\n    }\n  };\n\n  _xlsx._getTableStyles = function (e, t) {\n    for (var o = e.split(\"<tableStyle \"), r = o.length; --r;) {\n      var l = {},\n          i = o[r];\n      l.name = this._getAttr(i, \"name\");\n\n      for (var s = i.split(\"<tableStyleElement \"), n = s.length; --n;) {\n        var a = s[n],\n            h = this._getAttr(a, \"type\");\n\n        switch (h) {\n          case \"firstRowStripe\":\n            h = \"firstBandedRowStyle\";\n            break;\n\n          case \"secondRowStripe\":\n            h = \"secondBandedRowStyle\";\n            break;\n\n          case \"firstColumnStripe\":\n            h = \"firstBandedColumnStyle\";\n            break;\n\n          case \"secondColumnStripe\":\n            h = \"secondBandedColumnStyle\";\n            break;\n\n          default:\n            h += \"Style\";\n        }\n\n        var f = this._getAttr(a, \"dxfId\");\n\n        \"\" !== f && (l[h] = this._getTableStyleElement(t[+f + 1]));\n\n        var u = this._getAttr(a, \"size\");\n\n        if (u) {\n          null == l[h] && (l[h] = {});\n          l[h].size = +u;\n        }\n      }\n\n      this._tableStyles.push(l);\n    }\n  };\n\n  _xlsx._getTableStyleElement = function (e) {\n    var t = null,\n        o = null,\n        r = null,\n        l = null,\n        i = e.indexOf(\"<font>\");\n\n    if (i >= 0) {\n      t = e.substring(i, e.indexOf(\"</font>\"));\n\n      var s = this._getChildNodeValue(t, \"sz\");\n\n      o = {\n        bold: \"1\" === this._getChildNodeValue(t, \"b\"),\n        italic: \"1\" === this._getChildNodeValue(t, \"i\"),\n        underline: \"1\" === this._getChildNodeValue(t, \"u\"),\n        size: Math.round(s ? 96 * +s / 72 : 14),\n        family: this._getChildNodeValue(t, \"name\"),\n        color: this._getColor(t, !1)\n      };\n    }\n\n    t = null;\n\n    if ((i = e.indexOf(\"<fill>\")) >= 0) {\n      t = e.substring(i, e.indexOf(\"</fill>\"));\n      r = {\n        color: this._getColor(t, !0)\n      };\n    }\n\n    t = null;\n\n    if ((i = e.indexOf(\"<border>\")) >= 0) {\n      t = e.substring(i, e.indexOf(\"</border>\"));\n      l = {\n        left: this._getEdgeBorder(t, \"left\"),\n        right: this._getEdgeBorder(t, \"right\"),\n        top: this._getEdgeBorder(t, \"top\"),\n        bottom: this._getEdgeBorder(t, \"bottom\"),\n        vertical: this._getEdgeBorder(t, \"vertical\"),\n        horizontal: this._getEdgeBorder(t, \"horizontal\")\n      };\n    }\n\n    return {\n      font: o,\n      fill: r,\n      borders: l\n    };\n  };\n\n  _xlsx._getTableStyleByName = function (e) {\n    var t, o;\n    if (null == this._tableStyles || 0 === this._tableStyles.length) return null;\n\n    for (t = 0; t < this._tableStyles.length; t++) {\n      if ((o = this._tableStyles[t]) && o.name.toLowerCase() === e.toLowerCase()) return o;\n    }\n\n    return null;\n  };\n\n  _xlsx._getHyperlink = function (e, t) {\n    var o, r, l, i, s, n;\n\n    if (null != (o = this._getAttr(t, \"ref\"))) {\n      l = o.split(\":\");\n      null == (s = this._getAttr(t, \"r:id\")) && (n = this._getAttr(t, \"location\"));\n\n      for (var a = 0; a < l.length; a++) {\n        r = l[a];\n        i = Workbook.tableAddress(r);\n\n        if (s) {\n          null == e.hyperlinkRIds && (e.hyperlinkRIds = []);\n          e.hyperlinkRIds.push({\n            ref: i,\n            rId: s\n          });\n        } else n && e.rows[i.row] && e.rows[i.row].cells[i.col] && (e.rows[i.row].cells[i.col].link = n);\n      }\n    }\n  };\n\n  _xlsx._getTextRunFont = function (e) {\n    var t,\n        o = this._getChildNodeValue(e, \"sz\");\n\n    return {\n      bold: e.indexOf(\"<b/>\") >= 0 || \"true\" === this._getChildNodeValue(e, \"b\"),\n      italic: e.indexOf(\"<i/>\") >= 0 || \"true\" === this._getChildNodeValue(e, \"i\"),\n      underline: e.indexOf(\"<u/>\") >= 0 || (t = this._getChildNodeValue(e, \"u\")) && \"none\" !== t,\n      size: Math.round(o ? 96 * +o / 72 : 14),\n      family: this._getChildNodeValue(e, \"rFont\"),\n      color: this._getColor(e, !1)\n    };\n  };\n\n  _xlsx._getTextOfTextRuns = function (e) {\n    var t,\n        o,\n        r = \"\";\n\n    for (t = 0; t < e.length; t++) {\n      (o = e[t]) && (r += o.text);\n    }\n\n    return r;\n  };\n\n  _xlsx._isBuiltInStyleName = function (e) {\n    var t;\n\n    if (0 === e.search(/TableStyleLight/i)) {\n      t = +e.substring(15);\n      if (!isNaN(t) && t >= 1 && t <= 21) return !0;\n    } else if (0 === e.search(/TableStyleMedium/i)) {\n      t = +e.substring(16);\n      if (!isNaN(t) && t >= 1 && t <= 28) return !0;\n    } else if (0 === e.search(/TableStyleDark/i)) {\n      t = +e.substring(14);\n      if (!isNaN(t) && t >= 1 && t <= 11) return !0;\n    }\n\n    return !1;\n  };\n\n  _xlsx._generateRelsDoc = function () {\n    return '<Relationships xmlns=\"' + this._relationshipsNS + '\"><Relationship Target=\"docProps/app.xml\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties\" Id=\"rId3\"/><Relationship Target=\"docProps/core.xml\" Type=\"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\" Id=\"rId2\"/><Relationship Target=\"xl/workbook.xml\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Id=\"rId1\"/></Relationships>';\n  };\n\n  _xlsx._generateThemeDoc = function () {\n    return '<a:theme name=\"Office Theme\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\"><a:themeElements>' + this._generateClrScheme() + this._generateFontScheme() + this._generateFmtScheme() + \"</a:themeElements><a:objectDefaults/><a:extraClrSchemeLst/></a:theme>\";\n  };\n\n  _xlsx._generateClrScheme = function () {\n    null === this._colorThemes && (this._colorThemes = []);\n    return '<a:clrScheme name=\"Office\"><a:dk1><a:sysClr lastClr=\"' + (this._colorThemes[1] || \"000000\") + '\" val=\"windowText\"/></a:dk1><a:lt1><a:sysClr lastClr=\"' + (this._colorThemes[0] || \"FFFFFF\") + '\" val=\"window\"/></a:lt1><a:dk2><a:srgbClr val=\"' + (this._colorThemes[3] || \"1F497D\") + '\"/></a:dk2><a:lt2><a:srgbClr val=\"' + (this._colorThemes[2] || \"EEECE1\") + '\"/></a:lt2><a:accent1><a:srgbClr val=\"' + (this._colorThemes[4] || \"4F81BD\") + '\"/></a:accent1><a:accent2><a:srgbClr val=\"' + (this._colorThemes[5] || \"C0504D\") + '\"/></a:accent2><a:accent3><a:srgbClr val=\"' + (this._colorThemes[6] || \"9BBB59\") + '\"/></a:accent3><a:accent4><a:srgbClr val=\"' + (this._colorThemes[7] || \"8064A2\") + '\"/></a:accent4><a:accent5><a:srgbClr val=\"' + (this._colorThemes[8] || \"4BACC6\") + '\"/></a:accent5><a:accent6><a:srgbClr val=\"' + (this._colorThemes[9] || \"F79646\") + '\"/></a:accent6><a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink><a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink></a:clrScheme>';\n  };\n\n  _xlsx._generateFontScheme = function () {\n    return '<a:fontScheme name=\"Office\"><a:majorFont><a:latin typeface=\"Cambria\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font typeface=\"ＭＳ Ｐゴシック\" script=\"Jpan\"/><a:font typeface=\"맑은 고딕\" script=\"Hang\"/><a:font typeface=\"宋体\" script=\"Hans\"/><a:font typeface=\"新細明體\" script=\"Hant\"/><a:font typeface=\"Times New Roman\" script=\"Arab\"/><a:font typeface=\"Times New Roman\" script=\"Hebr\"/><a:font typeface=\"Tahoma\" script=\"Thai\"/><a:font typeface=\"Nyala\" script=\"Ethi\"/><a:font typeface=\"Vrinda\" script=\"Beng\"/><a:font typeface=\"Shruti\" script=\"Gujr\"/><a:font typeface=\"MoolBoran\" script=\"Khmr\"/><a:font typeface=\"Tunga\" script=\"Knda\"/><a:font typeface=\"Raavi\" script=\"Guru\"/><a:font typeface=\"Euphemia\" script=\"Cans\"/><a:font typeface=\"Plantagenet Cherokee\" script=\"Cher\"/><a:font typeface=\"Microsoft Yi Baiti\" script=\"Yiii\"/><a:font typeface=\"Microsoft Himalaya\" script=\"Tibt\"/><a:font typeface=\"MV Boli\" script=\"Thaa\"/><a:font typeface=\"Mangal\" script=\"Deva\"/><a:font typeface=\"Gautami\" script=\"Telu\"/><a:font typeface=\"Latha\" script=\"Taml\"/><a:font typeface=\"Estrangelo Edessa\" script=\"Syrc\"/><a:font typeface=\"Kalinga\" script=\"Orya\"/><a:font typeface=\"Kartika\" script=\"Mlym\"/><a:font typeface=\"DokChampa\" script=\"Laoo\"/><a:font typeface=\"Iskoola Pota\" script=\"Sinh\"/><a:font typeface=\"Mongolian Baiti\" script=\"Mong\"/><a:font typeface=\"Times New Roman\" script=\"Viet\"/><a:font typeface=\"Microsoft Uighur\" script=\"Uigh\"/><a:font typeface=\"Sylfaen\" script=\"Geor\"/></a:majorFont><a:minorFont><a:latin typeface=\"Calibri\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font typeface=\"ＭＳ Ｐゴシック\" script=\"Jpan\"/><a:font typeface=\"맑은 고딕\" script=\"Hang\"/><a:font typeface=\"宋体\" script=\"Hans\"/><a:font typeface=\"新細明體\" script=\"Hant\"/><a:font typeface=\"Arial\" script=\"Arab\"/><a:font typeface=\"Arial\" script=\"Hebr\"/><a:font typeface=\"Tahoma\" script=\"Thai\"/><a:font typeface=\"Nyala\" script=\"Ethi\"/><a:font typeface=\"Vrinda\" script=\"Beng\"/><a:font typeface=\"Shruti\" script=\"Gujr\"/><a:font typeface=\"DaunPenh\" script=\"Khmr\"/><a:font typeface=\"Tunga\" script=\"Knda\"/><a:font typeface=\"Raavi\" script=\"Guru\"/><a:font typeface=\"Euphemia\" script=\"Cans\"/><a:font typeface=\"Plantagenet Cherokee\" script=\"Cher\"/><a:font typeface=\"Microsoft Yi Baiti\" script=\"Yiii\"/><a:font typeface=\"Microsoft Himalaya\" script=\"Tibt\"/><a:font typeface=\"MV Boli\" script=\"Thaa\"/><a:font typeface=\"Mangal\" script=\"Deva\"/><a:font typeface=\"Gautami\" script=\"Telu\"/><a:font typeface=\"Latha\" script=\"Taml\"/><a:font typeface=\"Estrangelo Edessa\" script=\"Syrc\"/><a:font typeface=\"Kalinga\" script=\"Orya\"/><a:font typeface=\"Kartika\" script=\"Mlym\"/><a:font typeface=\"DokChampa\" script=\"Laoo\"/><a:font typeface=\"Iskoola Pota\" script=\"Sinh\"/><a:font typeface=\"Mongolian Baiti\" script=\"Mong\"/><a:font typeface=\"Arial\" script=\"Viet\"/><a:font typeface=\"Microsoft Uighur\" script=\"Uigh\"/><a:font typeface=\"Sylfaen\" script=\"Geor\"/></a:minorFont></a:fontScheme>';\n  };\n\n  _xlsx._generateFmtScheme = function () {\n    return '<a:fmtScheme name=\"Office\">' + this._generateFillScheme() + this._generateLineStyles() + this._generateEffectScheme() + this._generateBgFillScheme() + \"</a:fmtScheme>\";\n  };\n\n  _xlsx._generateFillScheme = function () {\n    return '<a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin scaled=\"1\" ang=\"16200000\"/></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"51000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"80000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"94000\"/><a:satMod val=\"135000\"/></a:schemeClr></a:gs></a:gsLst><a:lin scaled=\"1\" ang=\"16200000\"/></a:gradFill></a:fillStyleLst>';\n  };\n\n  _xlsx._generateLineStyles = function () {\n    return '<a:lnStyleLst><a:ln algn=\"ctr\" cmpd=\"sng\" cap=\"flat\" w=\"9525\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"9500\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln algn=\"ctr\" cmpd=\"sng\" cap=\"flat\" w=\"25400\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln algn=\"ctr\" cmpd=\"sng\" cap=\"flat\" w=\"38100\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln></a:lnStyleLst>';\n  };\n\n  _xlsx._generateEffectScheme = function () {\n    return '<a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw dir=\"5400000\" rotWithShape=\"0\" dist=\"23000\" blurRad=\"40000\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw dir=\"5400000\" rotWithShape=\"0\" dist=\"23000\" blurRad=\"40000\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw dir=\"5400000\" rotWithShape=\"0\" dist=\"23000\" blurRad=\"40000\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst=\"orthographicFront\"><a:rot rev=\"0\" lon=\"0\" lat=\"0\"/></a:camera><a:lightRig dir=\"t\" rig=\"threePt\"><a:rot rev=\"1200000\" lon=\"0\" lat=\"0\"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d></a:effectStyle></a:effectStyleLst>';\n  };\n\n  _xlsx._generateBgFillScheme = function () {\n    return '<a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path></a:gradFill></a:bgFillStyleLst>';\n  };\n\n  _xlsx._generateCoreDoc = function (e) {\n    var t = '<cp:coreProperties xmlns:cp=\"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:dcterms=\"http://purl.org/dc/terms/\" xmlns:dcmitype=\"http://purl.org/dc/dcmitype/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">';\n    e.creator ? t += \"<dc:creator>\" + e.creator + \"</dc:creator>\" : t += \"<dc:creator/>\";\n    e.lastModifiedBy ? t += \"<cp:lastModifiedBy>\" + e.lastModifiedBy + \"</cp:lastModifiedBy>\" : t += \"<cp:lastModifiedBy/>\";\n    return t += '<dcterms:created xsi:type=\"dcterms:W3CDTF\">' + (e.created || new Date()).toISOString() + '</dcterms:created><dcterms:modified xsi:type=\"dcterms:W3CDTF\">' + (e.modified || new Date()).toISOString() + \"</dcterms:modified></cp:coreProperties>\";\n  };\n\n  _xlsx._generateSheetGlobalSetting = function (e, t, o) {\n    var r = t.rows && t.rows[0] && t.rows[0].cells ? t.rows[0].cells.length : 0,\n        l = ' xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\"';\n    this._sheetHasNotes(e) && (l += ' xmlns:xdr=\"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing\" xmlns:x14=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main\"');\n    l += ' xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">';\n    l += '<sheetPr><outlinePr summaryBelow=\"0\"/></sheetPr>';\n    l += '<dimension ref=\"A1' + (r > 0 ? \":\" + this._numAlpha(r - 1) + t.rows.length : \"\") + '\"/>';\n    l += '<sheetViews><sheetView workbookViewId=\"0\"';\n    e === o.activeWorksheet && (l += ' tabSelected=\"1\"');\n    var i = 0,\n        s = 0;\n\n    if (t.frozenPane && ((i = t.frozenPane.rows || 0) || (s = t.frozenPane.columns || 0))) {\n      l += \">\";\n      l += '<pane state=\"frozen\" activePane=\"' + (0 !== i && 0 !== s ? \"bottomRight\" : 0 !== i ? \"bottomLeft\" : \"topRight\") + '\" topLeftCell=\"' + (this._numAlpha(s) + (i + 1)) + '\" ySplit=\"' + i.toString() + '\" xSplit=\"' + s.toString() + '\"/>';\n      l += \"</sheetView>\";\n    } else l += \"/>\";\n\n    l += \"</sheetViews>\";\n    return l += '<sheetFormatPr defaultRowHeight=\"15\" x14ac:dyDescent=\"0.25\"/>';\n  };\n\n  _xlsx._generateCell = function (e, t, o, r, l, i) {\n    var s = '<c r=\"' + this._numAlpha(t) + (e + 1) + '\" s=\"' + o.toString() + '\"';\n    r && (s += ' t=\"' + r + '\"');\n    var n = \"\";\n\n    if (i) {\n      \"=\" === i[0] && (i = i.substring(1));\n      i = i.replace(/\\@\\s*/gi, \"[#This Row], \");\n      n += \"<f>\" + Workbook._escapeXML(i) + \"</f>\";\n    }\n\n    null != l && \"\" !== l && (n += \"<v>\" + l + \"</v>\");\n    return s + (n ? \">\" + n + \"</c>\" : \"/>\");\n  };\n\n  _xlsx._generateMergeSetting = function (e) {\n    for (var t = '<mergeCells count=\"' + e.length.toString() + '\">', o = 0; o < e.length; o++) {\n      t += '<mergeCell ref=\"' + e[o].join(\":\") + '\"/>';\n    }\n\n    return t + \"</mergeCells>\";\n  };\n\n  _xlsx._generateStyleDoc = function () {\n    var e = '<styleSheet xmlns=\"' + this._workbookNS + '\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\">',\n        t = \"\",\n        o = \"\",\n        r = [],\n        l = 0,\n        i = 0,\n        s = \"\",\n        n = \"\";\n    n = this._generateFontStyle({}, !0);\n    var a = \"\",\n        h = \"\";\n    h += this._generateFillStyle(\"none\", null);\n    h += this._generateFillStyle(\"gray125\", null);\n    var f = \"\",\n        u = \"\";\n    u += this._generateBorderStyle({});\n    var c = \"\",\n        d = \"\";\n    d += this._generateCellXfs(0, 0, 0, 0, {});\n\n    for (; l < this._styles.length;) {\n      var m = this._styles[l];\n\n      if (m) {\n        var p = 0;\n\n        if ((m = JSON.parse(m)).format && \"General\" !== m.format && (p = this._numFmts.indexOf(m.format)) < 0) {\n          var _ = r.indexOf(m.format);\n\n          if (-1 === _) {\n            r.push(m.format);\n            o += '<numFmt numFmtId=\"' + (p = 164 + i).toString() + '\" formatCode=\"' + m.format + '\"/>';\n            i++;\n          } else p = 164 + _;\n        }\n\n        var g = 0;\n\n        if (m.borders) {\n          var b = JSON.stringify(m.borders);\n\n          if ((g = this._borders.indexOf(b)) < 0) {\n            g = this._borders.push(b) - 1;\n            u += this._generateBorderStyle(m.borders);\n          }\n        }\n\n        var y = 0;\n\n        if (m.font) {\n          var x = JSON.stringify(m.font);\n\n          if ((y = this._fonts.indexOf(x)) < 0) {\n            y = this._fonts.push(x) - 1;\n            n += this._generateFontStyle(m.font);\n          }\n        }\n\n        var k = 0;\n\n        if (m.fill && m.fill.color) {\n          var v = JSON.stringify(m.fill);\n\n          if ((k = this._fills.indexOf(v)) < 0) {\n            k = this._fills.push(v) - 1;\n            h += this._generateFillStyle(\"solid\", m.fill.color);\n          }\n        }\n\n        d += this._generateCellXfs(p, g, y, k, m);\n      }\n\n      l++;\n    }\n\n    r = null;\n\n    if (i > 0) {\n      t = '<numFmts count=\"' + i + '\">';\n      t += o;\n      t += \"</numFmts>\";\n    } else t = '<numFmts count=\"0\"/>';\n\n    e += t;\n    s = '<fonts count=\"' + this._fonts.length + '\" x14ac:knownFonts=\"1\">';\n    s += n;\n    e += s += \"</fonts>\";\n    a = '<fills count=\"' + this._fills.length + '\">';\n    a += h;\n    e += a += \"</fills>\";\n    f = '<borders count=\"' + this._borders.length + '\">';\n    f += u;\n    e += f += \"</borders>\";\n    e += '<cellStyleXfs count=\"1\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\"/></cellStyleXfs>';\n    c = '<cellXfs count=\"' + this._styles.length + '\">';\n    c += d;\n    c += \"</cellXfs>\";\n    var S = \"\",\n        w = \"\";\n\n    if (this._tableStyles.length > 0) {\n      this._getDxfs();\n\n      this._dxfs.length > 0 && (S = this._generateDxfs());\n      w = this._generateTableStyles();\n    }\n\n    return e += c + '<cellStyles count=\"1\"><cellStyle xfId=\"0\" builtinId=\"0\" name=\"Normal\"/></cellStyles>' + (\"\" === S ? '<dxfs count=\"0\"/>' : S) + (\"\" === w ? '<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleLight16\"/>' : w) + '<extLst><ext uri=\"{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}\"><x14ac:slicerStyles defaultSlicerStyle=\"SlicerStyleLight1\" xmlns:x14=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main\"/></ext></extLst></styleSheet>';\n  };\n\n  _xlsx._generateBorderStyle = function (e, t) {\n    void 0 === t && (t = !1);\n    var o,\n        r,\n        l = \"<border>\";\n\n    for (var i in {\n      left: 0,\n      right: 0,\n      top: 0,\n      bottom: 0,\n      diagonal: 0,\n      vertical: 0,\n      horizontal: 0\n    }) {\n      if (t || \"vertical\" !== i && \"horizontal\" !== i) {\n        if (e[i]) {\n          o = \"<\" + i + ' style=\"' + e[i].style + '\">';\n          \"\";\n          6 === (r = (r = e[i].color) ? \"#\" === r[0] ? r.substring(1) : r : \"\").length && (r = \"FF\" + r);\n          r || (r = \"FF000000\");\n          o += '<color rgb=\"' + r + '\"/>';\n          o += \"</\" + i + \">\";\n        } else o = \"<\" + i + \"/>\";\n\n        l += o;\n      }\n    }\n\n    return l += \"</border>\";\n  };\n\n  _xlsx._generateFontStyle = function (e, t, o) {\n    void 0 === t && (t = !1);\n    void 0 === o && (o = !1);\n    var r = o ? \"<rPr>\" : \"<font>\";\n    e.bold && (r += \"<b/>\");\n    e.italic && (r += \"<i/>\");\n    e.underline && (r += \"<u/>\");\n    r += '<sz val=\"' + (e.size ? Math.round(72 * e.size / 96) : this._defaultFontSize) + '\"/>';\n    e.color ? r += '<color rgb=\"FF' + this._parseColor(e.color).substring(1) + '\"/>' : r += '<color theme=\"1\"/>';\n    r += \"<\" + (o ? \"rFont\" : \"name\") + ' val=\"' + (e.family || this._defaultFontName) + '\" />';\n    r += '<family val=\"2\"/>';\n    t && (r += '<scheme val=\"minor\"/>');\n    return r += o ? \"</rPr>\" : \"</font>\";\n  };\n\n  _xlsx._generateFillStyle = function (e, t, o) {\n    void 0 === o && (o = !1);\n    var r,\n        l = '<fill><patternFill patternType=\"' + e + '\">';\n\n    if (t) {\n      r = o ? \"<bgColor \" : \"<fgColor \";\n      l += r += 'rgb=\"FF' + (\"#\" === t[0] ? t.substring(1) : t) + '\"/>';\n    }\n\n    return l += \"</patternFill></fill>\";\n  };\n\n  _xlsx._generateCellXfs = function (e, t, o, r, l) {\n    var i = '<xf xfId=\"0\" ';\n    i += 'numFmtId=\"' + e.toString() + '\" ';\n    e > 0 && (i += 'applyNumberFormat=\"1\" ');\n    i += 'borderId=\"' + t.toString() + '\" ';\n    t > 0 && (i += 'applyBorder=\"1\" ');\n    i += 'fontId=\"' + o.toString() + '\" ';\n    o > 0 && (i += 'applyFont=\"1\" ');\n    i += 'fillId=\"' + r.toString() + '\" ';\n    r > 0 && (i += 'applyFill=\"1\" ');\n    l.quotePrefix && (i += 'quotePrefix=\"1\" ');\n\n    if (l.hAlign || l.vAlign || l.indent || l.wordWrap) {\n      i += 'applyAlignment=\"1\">';\n      var s = \"<alignment \";\n      l.hAlign && (s += 'horizontal=\"' + l.hAlign + '\" ');\n      l.vAlign && (s += 'vertical=\"' + l.vAlign + '\" ');\n      l.indent && (s += 'indent=\"' + l.indent + '\" ');\n      l.wordWrap && (s += 'wrapText=\"1\"');\n      i += s += \"/>\";\n      i += \"</xf>\";\n    } else i += \"/>\";\n\n    return i;\n  };\n\n  _xlsx._generateContentTypesDoc = function (e) {\n    var t = this,\n        o = '<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">',\n        r = e.sheets,\n        l = r.reduce(function (e, o, r) {\n      return e || t._sheetHasNotes(r);\n    }, this._sheetHasNotes(0));\n    this._macroEnabled && (o += '<Default ContentType=\"application/vnd.ms-office.vbaProject\" Extension=\"bin\"/>');\n    l && (o += '<Default Extension=\"vml\" ContentType = \"application/vnd.openxmlformats-officedocument.vmlDrawing\" />');\n    o += '<Default ContentType=\"application/vnd.openxmlformats-package.relationships+xml\" Extension=\"rels\"/><Default ContentType=\"application/xml\" Extension=\"xml\"/><Override ContentType=\"' + (this._macroEnabled ? \"application/vnd.ms-excel.sheet.macroEnabled.main+xml\" : \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\") + '\" PartName=\"/xl/workbook.xml\"/>';\n\n    for (var i = 0; i < this._contentTypes.length; i++) {\n      o += this._contentTypes[i];\n    }\n\n    o += '<Override ContentType=\"application/vnd.openxmlformats-officedocument.theme+xml\" PartName=\"/xl/theme/theme1.xml\"/><Override ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\" PartName=\"/xl/styles.xml\"/><Override ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\" PartName=\"/xl/sharedStrings.xml\"/><Override ContentType=\"application/vnd.openxmlformats-package.core-properties+xml\" PartName=\"/docProps/core.xml\"/><Override ContentType=\"application/vnd.openxmlformats-officedocument.extended-properties+xml\" PartName=\"/docProps/app.xml\"/>';\n\n    if (l) {\n      i = 0;\n\n      for (var s = 0; i < r.length; i++) {\n        this._sheetHasNotes(i) && (o += '<Override PartName=\"/xl/comments' + ++s + '.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\"/>');\n      }\n    }\n\n    for (i = 0; i < this._tables.length; i++) {\n      o += '<Override ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\" PartName=\"/xl/tables/' + this._tables[i] + '\"/>';\n    }\n\n    return o += \"</Types>\";\n  };\n\n  _xlsx._generateAppDoc = function (e) {\n    for (var t = '<Properties xmlns:vt=\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\" xmlns=\"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\"><Application>' + (e.application || \"wijmo.xlsx\") + '</Application><DocSecurity>0</DocSecurity><ScaleCrop>false</ScaleCrop><HeadingPairs><vt:vector baseType=\"variant\" size=\"2\"><vt:variant><vt:lpstr>Worksheets</vt:lpstr></vt:variant><vt:variant><vt:i4>' + this._props.length + '</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector baseType=\"lpstr\" size=\"' + this._props.length + '\">', o = 0; o < this._props.length; o++) {\n      t += \"<vt:lpstr>\" + this._props[o] + \"</vt:lpstr>\";\n    }\n\n    return t += \"</vt:vector></TitlesOfParts><Manager/><Company>\" + (e.company || \"GrapeCity, Inc.\") + \"</Company><LinksUpToDate>false</LinksUpToDate><SharedDoc>false</SharedDoc><HyperlinksChanged>false</HyperlinksChanged><AppVersion>1.0</AppVersion></Properties>\";\n  };\n\n  _xlsx._generateWorkbookRels = function () {\n    for (var e = '<Relationships xmlns=\"' + this._relationshipsNS + '\">', t = 0; t < this._xlRels.length; t++) {\n      e += this._xlRels[t];\n    }\n\n    e += '<Relationship Target=\"sharedStrings.xml\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\" Id=\"rId' + (this._xlRels.length + 1) + '\"/><Relationship Target=\"styles.xml\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\" Id=\"rId' + (this._xlRels.length + 2) + '\"/><Relationship Target=\"theme/theme1.xml\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\" Id=\"rId' + (this._xlRels.length + 3) + '\"/>';\n    this._macroEnabled && (e += '<Relationship Target=\"vbaProject.bin\" Type=\"http://schemas.microsoft.com/office/2006/relationships/vbaProject\" Id=\"rId' + (this._xlRels.length + 4) + '\"/>');\n    return e += \"</Relationships>\";\n  };\n\n  _xlsx._generateWorkbook = function (e) {\n    for (var t = '<workbook xmlns=\"' + this._workbookNS + '\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\"><fileVersion rupBuild=\"9303\" lowestEdited=\"5\" lastEdited=\"5\" appName=\"xl\"/><workbookPr/><bookViews><workbookView xWindow=\"480\" yWindow=\"60\" windowWidth=\"18195\" windowHeight=\"8505\"' + (null != e.activeWorksheet ? ' activeTab=\"' + e.activeWorksheet.toString() + '\"' : \"\") + \"/></bookViews><sheets>\", o = 0; o < this._worksheets.length; o++) {\n      t += this._worksheets[o];\n    }\n\n    t += \"</sheets>\";\n\n    if (e.definedNames && e.definedNames.length > 0) {\n      t += \"<definedNames>\";\n\n      for (o = 0; o < e.definedNames.length; o++) {\n        var r = -1;\n        e.definedNames[o].sheetName && (r = this._getSheetIndexBySheetName(e, e.definedNames[o].sheetName));\n        t += '<definedName name=\"' + e.definedNames[o].name + '\" ' + (r > -1 ? 'localSheetId=\"' + r + '\"' : \"\") + \">\" + e.definedNames[o].value + \"</definedName>\";\n      }\n\n      t += \"</definedNames>\";\n    }\n\n    return t += '<calcPr fullCalcOnLoad=\"1\"/></workbook>';\n  };\n\n  _xlsx._generateWorksheetRows = function (e, t, o, r, l, i, s, n, a, h) {\n    for (var f, u = this, c = o.rows, _loop_2 = function _loop_2(m, p) {\n      if (s && s.cancelled) return {\n        value: void 0\n      };\n\n      if (n && m - t > 100 && Date.now() - e > 100) {\n        setTimeout(function () {\n          if (!s || !s.cancelled) {\n            a(Math.round((m + 1) / c.length * 100));\n\n            u._generateWorksheetRows(Date.now(), m, o, r, l, i, s, n, a, h);\n          }\n        }, 0);\n        return {\n          value: void 0\n        };\n      }\n\n      var _ = -1,\n          g = c[m] && c[m].cells ? c[m].cells.length : 0,\n          b = null;\n\n      i.sheetData += '<row x14ac:dyDescent=\"0.25\" r=\"' + (m + 1).toString() + '\"';\n\n      if (c[m]) {\n        c[m].height && (i.sheetData += ' customHeight=\"1\" ht=\"' + (72 * +c[m].height / 96).toString() + '\"');\n        c[m].groupLevel && (i.sheetData += ' outlineLevel=\"' + c[m].groupLevel.toString() + '\"');\n\n        if (b = c[m].style ? d._cloneStyle(c[m].style) : null) {\n          (b = d._resolveStyleInheritance(b)).font && b.font.color && (b.font.color = d._parseColor(b.font.color));\n          b.fill && b.fill.color && (b.fill.color = d._parseColor(b.fill.color));\n          null == b.hAlign || isString(b.hAlign) || (b.hAlign = Workbook._parseHAlignToString(asEnum(b.hAlign, HAlign)));\n          null == b.vAlign || isString(b.vAlign) || (b.vAlign = Workbook._parseVAlignToString(asEnum(b.vAlign, VAlign)));\n          var y = JSON.stringify(b);\n          (T = d._styles.indexOf(y)) < 0 && (T = d._styles.push(y) - 1);\n          i.sheetData += ' customFormat=\"1\" s=\"' + T.toString() + '\"';\n        }\n      }\n\n      c[m] && !1 === c[m].visible && (i.sheetData += ' hidden=\"1\"');\n      c[m] && !0 === c[m].collapsed && (i.sheetData += ' collapsed=\"1\"');\n      i.sheetData += \">\";\n\n      for (; ++_ < g;) {\n        var x = c[m].cells[_];\n\n        if (null != x) {\n          var k = \"\",\n              v = -1,\n              S = x ? x.textRuns : null,\n              w = x && x.hasOwnProperty(\"value\") ? x.value : x,\n              C = x && x.style ? d._cloneStyle(x.style) : {};\n          C = d._resolveStyleInheritance(C);\n          var W = l[_];\n\n          if (W) {\n            W = d._resolveStyleInheritance(W);\n            C = d._extend(C, W);\n          }\n\n          b && (C = d._extend(C, b));\n\n          if (r) {\n            r = d._resolveStyleInheritance(r);\n            C = d._extend(C, r);\n          }\n\n          null == C.hAlign || isString(C.hAlign) || (C.hAlign = Workbook._parseHAlignToString(asEnum(C.hAlign, HAlign)));\n          null == C.vAlign || isString(C.vAlign) || (C.vAlign = Workbook._parseVAlignToString(asEnum(C.vAlign, VAlign)));\n          C.font && C.font.color && (C.font.color = d._parseColor(C.font.color));\n          C.fill && C.fill.color && (C.fill.color = d._parseColor(C.fill.color));\n\n          d._applyDefaultBorder(C);\n\n          if (C.borders) {\n            C.borders = d._extend({}, C.borders);\n\n            d._parseBorder(C.borders, !!C.fill && !!C.fill.color);\n          }\n\n          if (x && x.isDate && !isDate(w)) {\n            f = new Date(w);\n            isDate(f) && (w = f);\n          }\n\n          !isNumber(w) || !isNaN(w) && isFinite(w) || (w = w.toString());\n\n          if (S || w && isString(w) && (\"@\" === C.format || \"General\" === C.format || (+w).toString() !== w || !isFinite(+w))) {\n            d._sharedStrings[1]++;\n\n            if (\"'\" === (w = S ? \"{RichTextMark}\" + JSON.stringify(S) : Workbook._unescapeXML(w))[0]) {\n              C.quotePrefix = !0;\n              w = w.substring(1);\n            }\n\n            (v = d._sharedStrings[0].indexOf(w)) < 0 && (v = d._sharedStrings[0].push(w) - 1);\n            w = v;\n            k = \"s\";\n          } else if (isBoolean(w)) {\n            w = w ? 1 : 0;\n            k = \"b\";\n          } else if (isDate(w)) {\n            w = d._convertDate(w);\n            C.format = C.format || \"mm-dd-yy\";\n          } else isObject(w) && (w = null);\n\n          var T;\n          y = JSON.stringify(C);\n          (T = d._styles.indexOf(y)) < 0 && (T = d._styles.push(y) - 1);\n\n          if (x && (null != x.colSpan && x.colSpan > 1 || null != x.rowSpan && x.rowSpan > 1)) {\n            x.colSpan = x.colSpan || 1;\n            x.rowSpan = x.rowSpan || 1;\n            d._checkValidMergeCell(i.merges, m, x.rowSpan, _, x.colSpan) && i.merges.push([d._numAlpha(_) + (m + 1), d._numAlpha(_ + x.colSpan - 1) + (m + x.rowSpan)]);\n          }\n\n          if (x && x.link) {\n            null == i.hyperlinks && (i.hyperlinks = []);\n            i.hyperlinks.push({\n              ref: Workbook.xlsxAddress(m, _),\n              value: w,\n              href: x.link\n            });\n          }\n\n          C = null;\n          i.sheetData += d._generateCell(m, _, T, k, w, x && x.formula ? x.formula : null);\n        }\n      }\n\n      i.sheetData += \"</row>\";\n    }, d = this, m = t, p = c.length; m < p; m++) {\n      var _ = _loop_2(m);\n\n      if (\"object\" == _typeof(_)) return _.value;\n    }\n\n    isFunction(h) && h();\n  };\n\n  _xlsx._generateWorkSheet = function (e, t, o, r, l, i) {\n    var s = this,\n        n = t.sheets[e];\n    if (!n) throw \"Worksheet should not be empty!\";\n    i(0);\n\n    this._collectNotes(n, e);\n\n    var a = new _SyncPromise(r),\n        h = n.columns,\n        f = this._cloneColumnsStyle(h),\n        u = n.style ? this._cloneStyle(n.style) : null,\n        c = '<worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\"' + this._generateSheetGlobalSetting(e, n, t),\n        d = {\n      hyperlinks: [],\n      merges: [],\n      sheetData: \"<sheetData>\"\n    };\n\n    this._generateWorksheetRows(Date.now(), 0, n, u, f, d, r, l, i, function () {\n      var t = e + 1;\n      d.sheetData += \"</sheetData>\";\n\n      if (h && h.length > 0) {\n        c += \"<cols>\";\n\n        for (var r = 0; r < h.length; r++) {\n          c += s._generateWorksheetColumn(f[r], h[r], r);\n        }\n\n        var l = n._extraColumn;\n\n        if (l) {\n          l.min = Math.max(h.length, l.min);\n          l.min <= l.max && (c += s._generateWorksheetColumn(l.style, l, -1));\n        }\n\n        c += \"</cols>\";\n      }\n\n      d.sheetData = c + d.sheetData;\n      c = d.sheetData;\n      d.sheetData = null;\n      d.merges.length > 0 && (c += s._generateMergeSetting(d.merges));\n      var u = 1,\n          m = 0;\n      s._sheetHasNotes(e) && (m = u++);\n      var p = d.hyperlinks;\n\n      if (p && p.length > 0) {\n        c += \"<hyperlinks>\";\n\n        for (r = 0; r < p.length; r++) {\n          if (/\\'?(\\w+)\\'?\\!\\$?[A-Za-z]{1,2}\\$?\\d+(:\\$?[A-Za-z]{1,2}\\$?\\d+)?/.test(p[r].href) || /^\\$?[A-Za-z]{1,2}\\$?\\d+(:\\$?[A-Za-z]{1,2}\\$?\\d+)?$/.test(p[r].href)) c += '<hyperlink ref=\"' + p[r].ref + '\" display=\"' + p[r].value + '\" location=\"' + p[r].href + '\"/>';else {\n            null == n.externalLinks && (n.externalLinks = []);\n            n.externalLinks.push(p[r].href);\n            c += '<hyperlink ref=\"' + p[r].ref + '\" r:id=\"rId' + u + '\"/>';\n            u++;\n          }\n        }\n\n        c += \"</hyperlinks>\";\n      }\n\n      c += '<pageMargins left=\"0.7\" right=\"0.7\" top=\"0.75\" bottom=\"0.75\" header=\"0.3\" footer=\"0.3\"/>';\n\n      if (n.tables && n.tables.length > 0) {\n        c += '<tableParts count=\"' + n.tables.length + '\">';\n\n        for (r = 0; r < n.tables.length; r++) {\n          c += '<tablePart r:id=\"rId' + u + '\"/>';\n          u++;\n        }\n\n        c += \"</tableParts>\";\n      }\n\n      m > 0 && (c += '<legacyDrawing r:id=\"rId' + m + '\"/>');\n      c += \"</worksheet>\";\n      o.file(\"sheet\" + t + \".xml\", s._xmlDescription + c);\n      c = null;\n\n      var _ = '<Override ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\" PartName=\"/xl/worksheets/sheet' + t + '.xml\"/>';\n\n      s._contentTypes.unshift(_);\n\n      s._props.unshift(Workbook._escapeXML(n.name) || \"Sheet\" + t);\n\n      var g = '<Relationship Target=\"worksheets/sheet' + t + '.xml\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\" Id=\"rId' + t + '\"/>';\n\n      s._xlRels.unshift(g);\n\n      var b = '<sheet r:id=\"rId' + t + '\" sheetId=\"' + t + '\" name=\"' + (Workbook._escapeXML(n.name) || \"Sheet\" + t) + '\"' + (!1 === n.visible ? ' state=\"hidden\"' : \"\") + \"/>\";\n\n      s._worksheets.unshift(b);\n\n      i(100);\n      a.resolve();\n    });\n\n    return a;\n  };\n\n  _xlsx._generateWorksheetColumn = function (e, t, o) {\n    var r = -1,\n        l = \"\";\n\n    if (!this._isEmpty(e)) {\n      (e = this._resolveStyleInheritance(e)).font && e.font.color && (e.font.color = this._parseColor(e.font.color));\n      e.fill && e.fill.color && (e.fill.color = this._parseColor(e.fill.color));\n      null == e.hAlign || isString(e.hAlign) || (e.hAlign = Workbook._parseHAlignToString(asEnum(e.hAlign, HAlign)));\n      null == e.vAlign || isString(e.vAlign) || (e.vAlign = Workbook._parseVAlignToString(asEnum(e.vAlign, VAlign)));\n      var i = JSON.stringify(e);\n      (r = this._styles.indexOf(i)) < 0 && (r = this._styles.push(i) - 1);\n    }\n\n    if (!this._isEmpty(t)) {\n      var s = t.width;\n      s = null != s ? \"string\" == typeof s && s.indexOf(\"ch\") > -1 ? this._parseCharCountToCharWidth(s.substring(0, s.indexOf(\"ch\"))) : this._parsePixelToCharWidth(s) : 8.43;\n      if (-1 == o) l += '<col min=\"' + t.min + '\" max=\"' + t.max + '\"';else {\n        var n = (o + 1).toString();\n        l += '<col min=\"' + n + '\" max=\"' + n + '\"';\n      }\n      r >= 0 && (l += ' style=\"' + r.toString() + '\"');\n      s && (l += ' width=\"' + s + '\" customWidth=\"1\"');\n      !1 !== t.autoWidth && (l += ' bestFit=\"1\"');\n      !1 === t.visible && (l += ' hidden=\"1\"');\n      l += \"/>\";\n    }\n\n    return l;\n  };\n\n  _xlsx._generateSharedStringsDoc = function () {\n    for (var e = '<sst xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" count=\"' + this._sharedStrings[1] + '\" uniqueCount=\"' + this._sharedStrings[0].length + '\">', t = 0; t < this._sharedStrings[0].length; t++) {\n      e += \"<si>\";\n      var o = this._sharedStrings[0][t];\n      if (o && 0 === o.indexOf(\"{RichTextMark}\")) try {\n        var r = JSON.parse(o.substring(14));\n        e += this._generateTextRuns(r, this._defaultFontName.toLowerCase()) + \"</si>\";\n      } catch (t) {\n        e += this._generatePlainText(o) + \"</si>\";\n      } else e += this._generatePlainText(o) + \"</si>\";\n    }\n\n    return e + \"</sst>\";\n  };\n\n  _xlsx._generateTextRuns = function (e, t) {\n    var o = \"\";\n    if (e && e.length > 0) for (var r = 0; r < e.length; r++) {\n      o += \"<r>\";\n      var l = e[r];\n\n      if (l.font) {\n        var i = !l.font.family || l.font.family.toLowerCase() === t;\n        o += this._generateFontStyle(l.font, i, !0);\n      }\n\n      o += this._generatePlainText(l.text);\n      o += \"</r>\";\n    }\n    return o;\n  };\n\n  _xlsx._generatePlainText = function (e) {\n    if (\"\" === e) return \"<t/>\";\n    var t = \"<t\";\n    (isNullOrWhiteSpace(e) || /^\\s+\\w*|\\w*\\s+$/.test(e)) && (t += ' xml:space=\"preserve\"');\n    return t += \">\" + Workbook._escapeXML(e) + \"</t>\";\n  };\n\n  _xlsx._generateTable = function (e, t) {\n    var o = this._tables.length + 1,\n        r = \"table\" + o + \".xml\";\n    e.fileName = r;\n\n    this._tables.push(r);\n\n    var l = '<table ref=\"' + e.range + '\" displayName=\"' + e.name + '\" name=\"' + e.name + '\" id=\"' + o + '\" ' + (!1 === e.showHeaderRow ? 'headerRowCount=\"0\" ' : \"\") + (!0 === e.showTotalRow ? 'totalsRowCount=\"1\" ' : 'totalsRowShown=\"0\" ') + ' xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\">';\n    !1 !== e.showHeaderRow && (l += this._generateTableFilterSetting(e.range, e.showTotalRow, e.columns));\n    l += '<tableColumns count=\"' + e.columns.length + '\">';\n\n    for (var i = \"\", s = 0; s < e.columns.length; s++) {\n      var n = e.columns[s];\n      i += '<tableColumn name=\"' + n.name + '\" id=\"' + (s + 1) + '\" ';\n      n.totalRowFunction ? this._tableColumnFunctions.indexOf(n.totalRowFunction) > -1 ? i += 'totalsRowFunction=\"' + n.totalRowFunction + '\"/>' : i += 'totalsRowFunction=\"custom\"><totalsRowFormula>' + n.totalRowFunction + \"</totalsRowFormula></tableColumn>\" : i += (n.totalRowLabel ? 'totalsRowLabel=\"' + n.totalRowLabel + '\"' : \"\") + \"/>\";\n    }\n\n    l += i + \"</tableColumns>\";\n    l += '<tableStyleInfo name=\"' + e.style.name + '\" showColumnStripes=\"' + (e.showBandedColumns ? \"1\" : \"0\") + '\" showRowStripes=\"' + (e.showBandedRows ? \"1\" : \"0\") + '\" showLastColumn=\"' + (e.alterLastColumn ? \"1\" : \"0\") + '\" showFirstColumn=\"' + (e.alterFirstColumn ? \"1\" : \"0\") + '\"/></table>';\n\n    if (!this._isBuiltInStyleName(e.style.name)) {\n      var a = JSON.stringify(e.style);\n      -1 === this._tableStyles.indexOf(a) && this._tableStyles.push(a);\n    }\n\n    t.file(r, this._xmlDescription + l);\n    l = null;\n  };\n\n  _xlsx._generateTableFilterSetting = function (e, t, o) {\n    var r = e;\n\n    if (t) {\n      var l = r.indexOf(\":\") + 1,\n          i = Workbook.tableAddress(r.substring(r.indexOf(\":\") + 1));\n      i.row -= 1;\n      r = r.substring(0, l) + Workbook.xlsxAddress(i.row, i.col);\n    }\n\n    for (var s = '<autoFilter ref=\"' + r + '\"', n = \"\", a = 0; a < o.length; a++) {\n      !1 === o[a].showFilterButton && (n += '<filterColumn hiddenButton=\"1\" colId=\"' + a + '\"/>');\n    }\n\n    return s += \"\" === n ? \"/>\" : \">\" + n + \"</autoFilter>\";\n  };\n\n  _xlsx._generateHyperlinkRel = function (e, t) {\n    for (var o = \"\", r = 0; r < e.length; r++) {\n      o += '<Relationship TargetMode=\"External\" Target=\"' + e[r] + '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink\" Id=\"rId' + (t + r) + '\"/>';\n    }\n\n    return o;\n  };\n\n  _xlsx._getDxfs = function () {\n    for (var e, t = this, o = 0; o < this._tableStyles.length; o++) {\n      e = JSON.parse(this._tableStyles[o]);\n      Object.keys(e).forEach(function (o) {\n        var r,\n            l,\n            i = e[o];\n\n        if (i && !isString(i) && !t._isEmptyStyleEle(i)) {\n          r = JSON.stringify(i);\n\n          if (-1 === (l = t._dxfs.indexOf(r))) {\n            l = t._dxfs.push(r) - 1;\n            i.styleIndex = l;\n          }\n        }\n      });\n      this._tableStyles[o] = e;\n    }\n  };\n\n  _xlsx._generateDxfs = function () {\n    for (var e, t = '<dxfs count=\"' + this._dxfs.length + '\">', o = 0; o < this._dxfs.length; o++) {\n      t += \"<dxf>\";\n      (e = JSON.parse(this._dxfs[o])).font && (t += this._generateFontStyle(e.font));\n      e.fill && e.fill.color && (t += this._generateFillStyle(\"solid\", e.fill.color, !0));\n\n      if (e.borders && !this._isEmpty(e.borders)) {\n        e.borders = this._extend({}, e.borders);\n\n        this._parseBorder(e.borders, !1);\n\n        t += this._generateBorderStyle(e.borders, !0);\n      }\n\n      t += \"</dxf>\";\n    }\n\n    return t += \"</dxfs>\";\n  };\n\n  _xlsx._generateTableStyles = function () {\n    for (var e, t, o, r, l, i, s = '<tableStyles count=\"' + this._tableStyles.length + '\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleLight16\">', n = 0; n < this._tableStyles.length; n++) {\n      e = this._tableStyles[n];\n      t = Object.keys(e);\n      l = \"\";\n      i = 0;\n\n      for (var a = 0; a < t.length; a++) {\n        r = e[o = t[a]];\n\n        if (!isString(r)) {\n          i++;\n          l += \"<tableStyleElement\";\n          null != r.styleIndex && (l += ' dxfId=\"' + r.styleIndex + '\"');\n\n          switch (o) {\n            case \"firstBandedColumnStyle\":\n              l += ' type=\"firstColumnStripe\"';\n              null != r.size && (l += ' size=\"' + r.size + '\"');\n              break;\n\n            case \"secondBandedColumnStyle\":\n              l += ' type=\"secondColumnStripe\"';\n              null != r.size && (l += ' size=\"' + r.size + '\"');\n              break;\n\n            case \"firstBandedRowStyle\":\n              l += ' type=\"firstRowStripe\"';\n              null != r.size && (l += ' size=\"' + r.size + '\"');\n              break;\n\n            case \"secondBandedRowStyle\":\n              l += ' type=\"secondRowStripe\"';\n              null != r.size && (l += ' size=\"' + r.size + '\"');\n              break;\n\n            default:\n              l += ' type=\"' + o.substring(0, o.length - 5) + '\"';\n          }\n\n          l += \"/>\";\n        }\n      }\n\n      if (i > 0) {\n        s += '<tableStyle count=\"' + i + '\" name=\"' + e.name + '\" pivot=\"0\">';\n        s += l + \"</tableStyle>\";\n      }\n    }\n\n    return s += \"</tableStyles>\";\n  };\n\n  _xlsx._isEmptyStyleEle = function (e) {\n    return this._isEmpty(e.borders) && (this._isEmpty(e.fill) || isNullOrWhiteSpace(e.fill.color)) && (this._isEmpty(e.font) || !0 !== e.font.bold && isNullOrWhiteSpace(e.font.color) && isNullOrWhiteSpace(e.font.family) && !0 !== e.font.italic && null == e.font.size && !0 !== e.font.underline);\n  };\n\n  _xlsx._getTableFileName = function (e, t) {\n    for (var o = \"\", r = 0; r < e.length; r++) {\n      var l = e[r];\n\n      if (l.name === t) {\n        o = l.fileName;\n        break;\n      }\n    }\n\n    return o;\n  };\n\n  _xlsx._getColor = function (e, t) {\n    var o,\n        r = -1,\n        l = -1,\n        i = -1;\n    if (t && -1 === (r = e.search(/<fgcolor/i)) && -1 === (l = e.search(/<bgcolor/i)) || !t && -1 === (i = e.search(/<color/i))) return null;\n\n    if (t) {\n      var s = r >= 0 ? r : l,\n          n = s >= 0 ? e.search(/<\\/fgc/i) : e.indexOf(/<\\/bgc/i);\n      n = n > 0 ? n : e.indexOf(\"/>\");\n      e = e.substring(s, n);\n    } else e = e.substring(i);\n\n    if (-1 !== e.indexOf(\"rgb=\")) (o = this._getAttr(e, \"rgb\")) && 8 === o.length && (o = o.substring(2));else if (-1 !== e.indexOf(\"indexed\")) {\n      var a = +this._getAttr(e, \"indexed\");\n      o = this._indexedColors[a] || \"\";\n    } else if (-1 !== e.indexOf(\"auto\") && \"1\" === this._getAttr(e, \"auto\")) o = \"#000000\";else {\n      var h,\n          f = +this._getAttr(e, \"theme\");\n      -1 !== e.indexOf(\"tint\") && (h = +this._getAttr(e, \"tint\"));\n      o = this._getThemeColor(f, h);\n    }\n    return o && \"#\" === o[0] ? o : \"#\" + o;\n  };\n\n  _xlsx._getThemeColor = function (e, t) {\n    if (!this._colorThemes) return \"#000000\";\n    var o = this._colorThemes[e];\n\n    if (null != t) {\n      var r = new Color(\"#\" + o),\n          l = r.getHsl();\n      l[2] = t < 0 ? l[2] * (1 + t) : l[2] * (1 - t) + (1 - 1 * (1 - t));\n      return (r = Color.fromHsl(l[0], l[1], l[2])).toString().substring(1);\n    }\n\n    return o;\n  };\n\n  _xlsx._parseColor = function (e) {\n    var t = this._parsedColors[e];\n\n    if (!t) {\n      var o = new Color(e);\n      o.a < 1 && (o = Color.toOpaque(o));\n      this._parsedColors[e] = t = o.toString();\n    }\n\n    return t;\n  };\n\n  _xlsx._getsBaseSharedFormulas = function (e) {\n    var t,\n        o,\n        r,\n        l = e.match(/\\<f[^<]*ref[^<]*>[^<]+(?=\\<\\/f>)/g);\n    this._sharedFormulas = [];\n    if (l && l.length > 0) for (var i = 0; i < l.length; i++) {\n      t = l[i];\n      o = this._getAttr(t, \"si\");\n      r = (r = this._getAttr(t, \"ref\")) ? r.substring(0, r.indexOf(\":\")) : \"\";\n      t = t.replace(/(\\<f.*>)(.+)/, \"$2\");\n      this._sharedFormulas[+o] = this._parseSharedFormulaInfo(r, t);\n    }\n  };\n\n  _xlsx._parseSharedFormulaInfo = function (e, t) {\n    var o,\n        r,\n        l,\n        i,\n        s,\n        n = t.match(/(\\'?\\w+\\'?\\!)?(\\$?[A-Za-z]+)(\\$?\\d+)/g);\n    i = Workbook.tableAddress(e);\n\n    if (n && n.length > 0) {\n      s = [];\n\n      for (var a = 0; a < n.length; a++) {\n        o = n[a];\n        t = t.replace(o, \"{\" + a + \"}\");\n\n        if ((r = o.indexOf(\"!\")) > 0) {\n          l = o.substring(0, r);\n          o = o.substring(r + 1);\n        }\n\n        s[a] = {\n          cellAddress: Workbook.tableAddress(o),\n          sheetRef: l\n        };\n      }\n    }\n\n    return {\n      cellRef: i,\n      formula: t,\n      formulaRefs: s\n    };\n  };\n\n  _xlsx._getSharedFormula = function (e, t) {\n    var o, r, l, i, s, n, a, h, f, u, c, d;\n\n    if (this._sharedFormulas && this._sharedFormulas.length > 0 && (o = this._sharedFormulas[+e])) {\n      f = o.formula;\n\n      if ((u = o.formulaRefs) && u.length > 0) {\n        r = Workbook.tableAddress(t);\n        a = o.cellRef ? o.cellRef.row : 0;\n        h = o.cellRef ? o.cellRef.col : 0;\n        l = r.row - a;\n        i = r.col - h;\n\n        for (var m = 0; m < u.length; m++) {\n          s = (c = u[m]).cellAddress.row + (c.cellAddress.absRow ? 0 : l);\n          n = c.cellAddress.col + (c.cellAddress.absCol ? 0 : i);\n          d = Workbook.xlsxAddress(s, n, c.cellAddress.absRow, c.cellAddress.absCol);\n          null != c.sheetRef && \"\" !== c.sheetRef && (d = c.sheetRef + \"!\" + d);\n          f = f.replace(\"{\" + m + \"}\", d);\n        }\n      }\n\n      return f;\n    }\n\n    return \"\";\n  };\n\n  _xlsx._convertDate = function (e) {\n    var t,\n        o,\n        r = new Date(1900, 0, 0),\n        l = Date.UTC(1900, 0, 0),\n        i = \"[object Date]\" === Object.prototype.toString.call(e),\n        s = 6e4 * ((i ? e.getTimezoneOffset() : new Date().getTimezoneOffset()) - r.getTimezoneOffset()),\n        n = r.getTime() - l - 6e4 * r.getTimezoneOffset();\n    if (i) return (e.getTime() - r.getTime() - s + n) / 864e5 + 1;\n\n    if (isNumber(e)) {\n      t = e > 59 ? 1 : 0;\n      return 0 !== (s = 6e4 * ((o = new Date(1e3 * Math.round((+r + 864e5 * (e - t)) / 1e3))).getTimezoneOffset() - r.getTimezoneOffset())) ? new Date(1e3 * Math.round((+r + s - n + 864e5 * (e - t)) / 1e3)) : o;\n    }\n\n    return null;\n  };\n\n  _xlsx._parseBorder = function (e, t) {\n    for (var o in {\n      left: 0,\n      right: 0,\n      top: 0,\n      bottom: 0,\n      diagonal: 0\n    }) {\n      var r = e[o];\n\n      if (r) {\n        isString(r.color) && (r.color = this._parseColor(r.color));\n        null == r.style || isString(r.style) || (r.style = Workbook._parseBorderTypeToString(asEnum(r.style, BorderStyle, !1)));\n        !t && r.color && \"#c6c6c6\" === r.color.toLowerCase() && \"thin\" === r.style && (e[o] = null);\n      }\n    }\n  };\n\n  _xlsx._applyDefaultBorder = function (e) {\n    if (e.fill && e.fill.color) {\n      null == e.borders && (e.borders = {});\n\n      for (var t in {\n        left: 0,\n        right: 0,\n        top: 0,\n        bottom: 0\n      }) {\n        null == e.borders[t] && (e.borders[t] = {\n          style: BorderStyle.Thin,\n          color: \"#C6C6C6\"\n        });\n      }\n    }\n  };\n\n  _xlsx._resolveStyleInheritance = function (e) {\n    var t;\n    if (!e.basedOn) return e;\n\n    for (var o in e.basedOn) {\n      if (\"basedOn\" === o) {\n        t = this._resolveStyleInheritance(e.basedOn);\n\n        for (o in t) {\n          var r = t[o];\n          e[o] = null == e[o] ? r : this._extend(e[o], r);\n        }\n      } else {\n        r = e.basedOn[o];\n        e[o] = null == e[o] ? r : this._extend(e[o], r);\n      }\n    }\n\n    delete e.basedOn;\n    return e;\n  };\n\n  _xlsx._parsePixelToCharWidth = function (e) {\n    return null == e || isNaN(+e) ? null : ((+e - 5) / 7 * 100 + .5) / 100;\n  };\n\n  _xlsx._parseCharWidthToPixel = function (e) {\n    return null == e || isNaN(+e) ? null : Math.floor((256 * +e + 128 / 7) / 256 * 7) + 5;\n  };\n\n  _xlsx._parseCharCountToCharWidth = function (e) {\n    return null == e || isNaN(+e) ? null : (7 * +e + 5) / 7 * 256 / 256;\n  };\n\n  _xlsx._numAlpha = function (e) {\n    var t = Math.floor(e / 26) - 1;\n    return (t > -1 ? this._numAlpha(t) : \"\") + this._alphabet.charAt(e % 26);\n  };\n\n  _xlsx._alphaNum = function (e) {\n    return e.length > 1 ? (this._alphabet.indexOf(e[0]) + 1) * Math.pow(26, e.length - 1) + this._alphaNum(e.substring(1)) : this._alphabet.indexOf(e);\n  };\n\n  _xlsx._typeOf = function (e) {\n    return {}.toString.call(e).match(/\\s([a-zA-Z]+)/)[1].toLowerCase();\n  };\n\n  _xlsx._extend = function (e, t) {\n    if (isObject(e) && isObject(t)) {\n      for (var o in t) {\n        var r = t[o];\n        isObject(r) && null != e[o] ? this._extend(e[o], r) : null != r && null == e[o] && (e[o] = r);\n      }\n\n      return e;\n    }\n\n    return t;\n  };\n\n  _xlsx._isEmpty = function (e) {\n    var t = Object.prototype.hasOwnProperty;\n    if (null == e) return !0;\n    if (e.length > 0) return !1;\n    if (0 === e.length) return !0;\n\n    for (var o in e) {\n      if (t.call(e, o)) return !1;\n    }\n\n    return !0;\n  };\n\n  _xlsx._cloneStyle = function (e) {\n    var t;\n    if (null == e || \"object\" != _typeof(e)) return e;\n    t = {};\n\n    for (var o in e) {\n      e.hasOwnProperty(o) && (t[o] = this._cloneStyle(e[o]));\n    }\n\n    return t;\n  };\n\n  _xlsx._cloneColumnsStyle = function (e) {\n    for (var t, o = [], r = 0; r < e.length; r++) {\n      (t = e[r]) && t.style && (o[r] = this._cloneStyle(t.style));\n    }\n\n    return o;\n  };\n\n  _xlsx._getSheetIndex = function (e) {\n    return +(e = e.substring(0, e.lastIndexOf(\".xml\"))).substring(e.lastIndexOf(\"sheet\") + 5);\n  };\n\n  _xlsx._checkValidMergeCell = function (e, t, o, r, l) {\n    for (var i = 0; i < e.length; i++) {\n      var s = e[i],\n          n = +s[0].match(/\\d*/g).join(\"\") - 1,\n          a = this._alphaNum(s[0].match(/[a-zA-Z]*/g)[0]),\n          h = +s[1].match(/\\d*/g).join(\"\") - 1,\n          f = this._alphaNum(s[1].match(/[a-zA-Z]*/g)[0]);\n\n      if (!(t > h || t + o - 1 < n || r > f || r + l - 1 < a)) return !1;\n    }\n\n    return !0;\n  };\n\n  _xlsx._getAttr = function (e, t) {\n    var o = e.indexOf(t + '=\"');\n\n    if (o >= 0) {\n      o += t.length + 2;\n      return e.substring(o, e.indexOf('\"', o));\n    }\n\n    return \"\";\n  };\n\n  _xlsx._getChildNodeValue = function (e, t) {\n    var o = e.indexOf(t + ' val=\"');\n\n    if (o >= 0) {\n      o += t.length + 6;\n      return e.substring(o, e.indexOf('\"', o));\n    }\n\n    return \"\";\n  };\n\n  _xlsx._getElementValue = function (e, t, o, r) {\n    var l = e.indexOf(\"<\" + t);\n\n    if (l >= 0) {\n      var i = void 0;\n      (l = e.indexOf(\">\", l + 1 + t.length)) > 0 && \"/\" !== e[l - 1] && (i = e.substring(l + 1, e.indexOf(\"</\", l + 1)));\n      return i || r;\n    }\n\n    return o;\n  };\n\n  _xlsx._getSubElement = function (e, t) {\n    if (e) {\n      var o = e.indexOf(\"<\" + t);\n\n      if (o >= 0) {\n        var r = o + 1 + t.length,\n            l = e.indexOf(\"</\" + t, r);\n        l < 0 && (l = e.indexOf(\"/>\", r));\n        return e.substring(r, l);\n      }\n    }\n  };\n\n  _xlsx._getSheetIndexBySheetName = function (e, t) {\n    for (var o = 0; o < e.sheets.length; o++) {\n      if (e.sheets[o].name === t) return o;\n    }\n\n    return -1;\n  };\n\n  _xlsx._sheetHasNotes = function (e) {\n    return !!this._notes[e];\n  };\n\n  _xlsx._collectNotes = function (e, t) {\n    for (var o, r = e.rows, l = 0, i = r.length; l < i; l++) {\n      var s = r[l];\n      if (s) for (var n = 0, a = s.cells.length; n < a; n++) {\n        var h = s.cells[n];\n\n        if (h) {\n          var f = h.note;\n\n          if (f && (null != f.text || f.textRuns && f.textRuns.length > 0)) {\n            o || (o = this._notes[t]) || (this._notes[t] = o = []);\n            f._row = l;\n            f._col = n;\n            o.push(f);\n          }\n        }\n      }\n    }\n  };\n\n  _xlsx._alphabet = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n  _xlsx._indexedColors = [\"000000\", \"FFFFFF\", \"FF0000\", \"00FF00\", \"0000FF\", \"FFFF00\", \"FF00FF\", \"00FFFF\", \"000000\", \"FFFFFF\", \"FF0000\", \"00FF00\", \"0000FF\", \"FFFF00\", \"FF00FF\", \"00FFFF\", \"800000\", \"008000\", \"000080\", \"808000\", \"800080\", \"008080\", \"C0C0C0\", \"808080\", \"9999FF\", \"993366\", \"FFFFCC\", \"CCFFFF\", \"660066\", \"FF8080\", \"0066CC\", \"CCCCFF\", \"000080\", \"FF00FF\", \"FFFF00\", \"00FFFF\", \"800080\", \"800000\", \"008080\", \"0000FF\", \"00CCFF\", \"CCFFFF\", \"CCFFCC\", \"FFFF99\", \"99CCFF\", \"FF99CC\", \"CC99FF\", \"FFCC99\", \"3366FF\", \"33CCCC\", \"99CC00\", \"FFCC00\", \"FF9900\", \"FF6600\", \"666699\", \"969696\", \"003366\", \"339966\", \"003300\", \"333300\", \"993300\", \"993366\", \"333399\", \"333333\", \"000000\", \"FFFFFF\"];\n  _xlsx._numFmts = [\"General\", \"0\", \"0.00\", \"#,##0\", \"#,##0.00\",,, \"$#,##0.00_);($#,##0.00)\",, \"0%\", \"0.00%\", \"0.00E+00\", \"# ?/?\", \"# ??/??\", \"m/d/yyyy\", \"d-mmm-yy\", \"d-mmm\", \"mmm-yy\", \"h:mm AM/PM\", \"h:mm:ss AM/PM\", \"h:mm\", \"h:mm:ss\", \"m/d/yy h:mm\",,,,,,,,,,,,,,, \"#,##0 ;(#,##0)\", \"#,##0 ;[Red](#,##0)\", \"#,##0.00;(#,##0.00)\", \"#,##0.00;[Red](#,##0.00)\",,,,, \"mm:ss\", \"[h]:mm:ss\", \"mmss.0\", \"##0.0E+0\", \"@\"];\n  _xlsx._tableColumnFunctions = \"average, count, countNums, max, min, stdDev, sum, var\";\n  _xlsx._xmlDescription = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>';\n  _xlsx._workbookNS = \"http://schemas.openxmlformats.org/spreadsheetml/2006/main\";\n  _xlsx._relationshipsNS = \"http://schemas.openxmlformats.org/package/2006/relationships\";\n  _xlsx._defaultFontName = \"Calibri\";\n  _xlsx._defaultFontSize = 11;\n  _xlsx._macroEnabled = !1;\n  _xlsx._defaultColorThemes = [\"FFFFFF\", \"000000\", \"EEECE1\", \"1F497D\", \"4F818D\", \"C0504D\", \"9BBB59\", \"8064A2\", \"4BACC6\", \"F79646\"];\n  _xlsx._parsedColors = {};\n  return _xlsx;\n}();\n\nexport { _xlsx };\n\nvar _JSZipSyncPromise = function () {\n  function _JSZipSyncPromise(e) {\n    this.value = e;\n  }\n\n  _JSZipSyncPromise.prototype.then = function (e, t) {\n    return new _JSZipSyncPromise(e ? e(this.value) : null);\n  };\n\n  _JSZipSyncPromise.prototype.catch = function (e) {\n    return this.then(null, e);\n  };\n\n  _JSZipSyncPromise.resolve = function () {\n    return new _JSZipSyncPromise();\n  };\n\n  return _JSZipSyncPromise;\n}(),\n    _JsZipWrapper = function () {\n  function _JsZipWrapper(e) {\n    this._obj = e;\n  }\n\n  _JsZipWrapper.prototype.loadAsync = function () {\n    for (var e, t = [], o = 0; o < arguments.length; o++) {\n      t[o] = arguments[o];\n    }\n\n    var r = (e = this._obj).load.apply(e, t);\n\n    return new _JSZipSyncPromise(this._wrapOrNull(r));\n  };\n\n  _JsZipWrapper.prototype.file = function () {\n    for (var e, t = [], o = 0; o < arguments.length; o++) {\n      t[o] = arguments[o];\n    }\n\n    var r = (e = this._obj).file.apply(e, t);\n\n    return this._wrapOrNull(r);\n  };\n\n  Object.defineProperty(_JsZipWrapper.prototype, \"name\", {\n    get: function get() {\n      return this._obj.name;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n\n  _JsZipWrapper.prototype.async = function () {\n    for (var e, t = [], o = 0; o < arguments.length; o++) {\n      t[o] = arguments[o];\n    }\n\n    e = t && t.length > 0 && \"uint8array\" === t[0].toLowerCase() ? this._obj.asUint8Array() : this._obj.asText();\n    return new _JSZipSyncPromise(e);\n  };\n\n  _JsZipWrapper.prototype.folder = function (e) {\n    var t = this._obj.folder(e);\n\n    return this._wrapOrNull(t);\n  };\n\n  _JsZipWrapper.prototype.forEach = function (e) {\n    var t = this._obj.root,\n        o = t.length,\n        r = this._obj.files;\n\n    for (var l in r) {\n      l.length > o && l.substr(0, o).toLowerCase() === t && e(l.substr(o), new _JsZipWrapper(r[l]));\n    }\n  };\n\n  _JsZipWrapper.prototype._wrapOrNull = function (e) {\n    return null != e ? new _JsZipWrapper(e) : null;\n  };\n\n  return _JsZipWrapper;\n}(),\n    _SyncPromise = function () {\n  function _SyncPromise(e, t) {\n    this._callbacks = [];\n    this._cs = e;\n    this._onCancel = t;\n  }\n\n  _SyncPromise.serial = function (e, t) {\n    t = t.slice();\n\n    var o = new _SyncPromise(e),\n        r = [],\n        drain = function drain() {\n      o.cancelled ? t = [] : t.length ? t.shift()().then(function (e) {\n        r.push(e);\n        drain();\n      }, function (e) {\n        t = [];\n        o.reject(e);\n      }) : o.resolve(r);\n    };\n\n    drain();\n    return o;\n  };\n\n  _SyncPromise.prototype.cancel = function (e) {\n    void 0 === e && (e = !0);\n    this._cancelled = !0;\n    e && this._onCancel && this._onCancel();\n  };\n\n  Object.defineProperty(_SyncPromise.prototype, \"cancelled\", {\n    get: function get() {\n      return this._cancelled || this._cs && this._cs.cancelled;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n\n  _SyncPromise.prototype.then = function (e, t) {\n    this._callbacks.push({\n      onFulfilled: e,\n      onRejected: t\n    });\n\n    this._resolved && this.resolve(this._resolved.value);\n    return this;\n  };\n\n  _SyncPromise.prototype.catch = function (e) {\n    return this.then(null, e);\n  };\n\n  _SyncPromise.prototype.resolve = function (e) {\n    if (this.cancelled) return this;\n    this._resolved = {\n      value: e\n    };\n\n    try {\n      this.onFulfilled(e);\n    } catch (e) {\n      this.onRejected(e);\n    }\n\n    return this;\n  };\n\n  _SyncPromise.prototype.reject = function (e) {\n    if (this.cancelled) return this;\n    this.onRejected(e);\n    return this;\n  };\n\n  _SyncPromise.prototype.onFulfilled = function (e) {\n    for (; this._callbacks.length;) {\n      var t = this._callbacks[0];\n      t.onFulfilled && t.onFulfilled(e);\n\n      this._callbacks.shift();\n    }\n  };\n\n  _SyncPromise.prototype.onRejected = function (e) {\n    for (var t; t = this._callbacks.shift();) {\n      t.onRejected && t.onRejected(e);\n    }\n  };\n\n  return _SyncPromise;\n}();\n\nexport { _SyncPromise };\n\nvar _NotePositionConverter = function () {\n  function _NotePositionConverter(e) {\n    this._colsWidthCnt = 0;\n    this._colsWidth = [];\n    this._rowsHeightCnt = 0;\n    this._rowsHeight = [];\n    this._cols = e.columns;\n    this._rows = e.rows;\n  }\n\n  _NotePositionConverter.prototype.toAnchor = function (e, t, o) {\n    var r,\n        l,\n        i,\n        s,\n        n,\n        a,\n        h,\n        f,\n        u = e.offsetX,\n        c = e.offsetY;\n\n    if (u < 0) {\n      var d = void 0;\n\n      for (r = o, l = -u; r >= 0 && !(l <= (d = this._getColWidth(r))); r--) {\n        l -= d;\n      }\n\n      l = d - l;\n    } else for (r = o + 1, l = u; l >= 0; r++) {\n      if (l <= (d = this._getColWidth(r))) break;\n      l -= d;\n    }\n\n    if (c < 0) for (i = t - 1, s = -c; i >= 0; i--) {\n      if (s <= (m = this._getRowHeight(i))) break;\n      s -= m;\n    } else for (i = t, s = c; s >= 0; i++) {\n      var m;\n      if (s <= (m = this._getRowHeight(i))) break;\n      s -= m;\n    }\n\n    for (n = r, a = l + e.width; a >= 0; n++) {\n      if (a <= (d = this._getColWidth(n))) break;\n      a -= d;\n    }\n\n    for (h = i, f = s + e.height; f >= 0; h++) {\n      var p = this._getRowHeight(h);\n\n      if (f <= p) break;\n      f -= p;\n    }\n\n    return [r, l, i, s, n, a, h, f];\n  };\n\n  _NotePositionConverter.prototype.fromAnchor = function (e, t, o, r) {\n    var l = e[0],\n        i = e[1],\n        s = e[2],\n        n = e[3],\n        a = e[4],\n        h = e[5],\n        f = e[6],\n        u = e[7],\n        c = 0;\n    if (r === l) c = -(this._getColWidth(r) - i);else if (l > r) {\n      c += i;\n\n      for (var d = r + 1, m = l - 1; d <= m; d++) {\n        c += this._getColWidth(d);\n      }\n    } else {\n      for (d = l + 1, m = r; d <= m; d++) {\n        c -= this._getColWidth(d);\n      }\n\n      c -= this._getColWidth(l) - i;\n    }\n    var p = 0;\n    if (o === s) p = n;else if (s > o) {\n      for (var _ = o, g = s - 1; _ <= g; _++) {\n        p += this._getRowHeight(_);\n      }\n\n      p += n;\n    } else {\n      var b = s + 1;\n\n      for (g = o; b < g; b++) {\n        p -= this._getRowHeight(b);\n      }\n\n      p -= this._getRowHeight(s) - n;\n    }\n    var y = 0;\n    if (l === a) y = h - i;else {\n      for (d = l + 1, m = a - 1; d <= m; d++) {\n        y += this._getColWidth(d);\n      }\n\n      y += this._getColWidth(l) - i;\n      y += h;\n    }\n    var x = 0;\n    if (s === f) x = u - n;else {\n      var k = s + 1;\n\n      for (g = f - 1; k <= g; k++) {\n        x += this._getRowHeight(k);\n      }\n\n      x += this._getRowHeight(s) - n;\n      x += u;\n    }\n    t.offsetX = c;\n    t.offsetY = p;\n    t.width = y;\n    t.height = x;\n  };\n\n  _NotePositionConverter.prototype._getColWidth = function (e) {\n    var t = this._colsWidth[e];\n\n    if (null == t) {\n      if (this._colsWidthCnt > 1e3) {\n        this._colsWidth = [];\n        this._colsWidthCnt = 0;\n      }\n\n      var o = this._cols[e];\n      t = !o || null == o.visible || o.visible ? o && null != o.width ? Math.max(o.width - 5, 0) : 64 : 0;\n      this._colsWidth[e] = t;\n      this._colsWidthCnt++;\n    }\n\n    return t;\n  };\n\n  _NotePositionConverter.prototype._getRowHeight = function (e) {\n    var t = this._rowsHeight[e];\n\n    if (null == t) {\n      if (this._rowsHeightCnt > 1e3) {\n        this._rowsHeight = [];\n        this._rowsHeightCnt = 0;\n      }\n\n      var o = this._rows[e];\n      t = !o || null == o.visible || o.visible ? o && null != o.height ? o.height : 20 : 0;\n      this._rowsHeight[e] = t;\n      this._rowsHeightCnt++;\n    }\n\n    return t;\n  };\n\n  return _NotePositionConverter;\n}();\n\nexport function _map(e, t, o, r, l) {\n  var i = o - t;\n  0 == i && (i = 1);\n  return (e - t) * ((l - r) / i) + r;\n}\n\nvar fromCodePointImpl = String.fromCodePoint || function (e) {\n  if (e <= 65535) return String.fromCharCode(e);\n  e -= 65536;\n  return String.fromCharCode(55296 + (e >> 10), e % 1024 + 56320);\n},\n    _uid = 0;\n\nfunction _guid() {\n  _uid > 4294967295 && (_uid = 0);\n  var e = (65535 & _uid | 65536).toString(16).substr(1),\n      t = (_uid >> 16 & 65535 | 65536).toString(16).substr(1);\n  _uid++;\n  return \"{00000000-0000-0000-0000\" + t + e + \"}\";\n}\n\n_registerModule(\"wijmo.xlsx\", selfModule);","map":null,"metadata":{},"sourceType":"module"}